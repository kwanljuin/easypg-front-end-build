(self["webpackChunk"]=self["webpackChunk"]||[]).push([[371],{76063:function(e){e.exports={actionButton:"actionButton___2STiz"}},95657:function(e){e.exports={actionButton:"actionButton___15rFb"}},46888:function(e){e.exports={actionButton:"actionButton___2Bp6Y"}},18910:function(e){e.exports={actionButton:"actionButton___2XPac"}},11493:function(e){e.exports={actionButton:"actionButton___Vskk9"}},42921:function(e){e.exports={actionButton:"actionButton___2FU4C"}},33026:function(e){e.exports={bigButton:"bigButton___2qf4t"}},21746:function(e){e.exports={bigButton:"bigButton___tcIYX"}},37217:function(e){e.exports={bigButton:"bigButton___1RHS2"}},11829:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return nt}});t(54421);var i=t(38272),a=(t(58024),t(39144)),l=(t(20228),t(11382)),r=(t(49111),t(19650)),o=(t(98858),t(4914)),s=(t(94233),t(51890)),u=(t(13254),t(14277)),d=(t(13062),t(71230)),c=(t(89032),t(15746)),v=t(8870),p=t(2824),h=(t(71194),t(50146)),m=(t(402),t(70647)),x=t(89366),Z=t(67294),g=t(28168),j=t(45004),f=t(8847),b=(t(57663),t(71577)),w=t(85369),k=t(33026),y=t.n(k),I=t(85893),S=e=>{var n=(0,Z.useState)(!1),t=(0,p.Z)(n,2),i=t[0],a=t[1],l=(0,Z.useState)(!1),r=(0,p.Z)(l,2),o=r[0],s=r[1],u=(0,Z.useState)("Content of the modal"),d=(0,p.Z)(u,2),c=d[0],v=d[1],m=()=>{a(!0)},x=()=>{a(!1)},g=()=>{v("The modal will be closed after two seconds"),s(!0),setTimeout((()=>{a(!1),s(!1)}),2e3)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(w.Z,{}),className:y().bigButton,onClick:m,children:"Gold Price Calculator"}),(0,I.jsx)(h.Z,{title:"Gold Price Calculator",visible:i,onOk:g,confirmLoading:o,onCancel:x,centered:!0,destroyOnClose:!0,children:(0,I.jsx)("p",{children:c})})]})},C=S,T=(t(84305),t(75901)),P=(t(71748),t(33860)),D=(t(48736),t(27049)),M=(t(34792),t(48086)),N=t(3182),R=t(94043),F=t.n(R),A=t(73171),V=t(12044),Y=t(49101),B=t(57895),_=t(952),E=t(61036),z=t(64317),W=t(5436),L=t(97462),O=t(5966),q=t(31199),G=t(59962),K=t(24739),U=t(10927),H=t(18253),J=t(41741),Q=t(17244),X=t(46747),$=t(3682),ee={NEW:"NEW",REVALUE:"REVALUE",REDEEM:"REDEEM",RENEW:"RENEW",EXTEND:"EXTEND"},ne=t(68438),te=(t(17673),e=>e[0].toUpperCase()+e.slice(1).toLowerCase()),ie=e=>e.filter(((n,t)=>t===e.findIndex((e=>e.value===n.value)))),ae=t(69483),le=t.n(ae),re=(t(14965),t(68588)),oe=(t(47673),t(4107)),se=(t(43185),t(94412)),ue=(t(12968),t(62462)),de=(t(9715),t(17681)),ce=(t(43358),t(34041)),ve=t(31223),pe=t(7085),he=t(30381),me=t.n(he),xe=["Malaysian","Thai","Vietnamese","Indonesian","Burmese","Sri Lankan","Bangladeshi","Cambodian","Indian","Pakistani","Filipino","Afghan","Albanian","Algerian","American","Andorran","Angolan","Antiguans","Argentinean","Armenian","Australian","Austrian","Azerbaijani","Bahamian","Bahraini","Bangladeshi","Barbadian","Barbudans","Batswana","Belarusian","Belgian","Belizean","Beninese","Bhutanese","Bolivian","Bosnian","Brazilian","British","Bruneian","Bulgarian","Burkinabe","Burmese","Burundian","Cambodian","Cameroonian","Canadian","Cape Verdean","Central African","Chadian","Chilean","Chinese","Colombian","Comoran","Congolese","Costa Rican","Croatian","Cuban","Cypriot","Czech","Danish","Djibouti","Dominican","Dutch","East Timorese","Ecuadorean","Egyptian","Emirian","Equatorial Guinean","Eritrean","Estonian","Ethiopian","Fijian","Filipino","Finnish","French","Gabonese","Gambian","Georgian","German","Ghanaian","Greek","Grenadian","Guatemalan","Guinea-Bissauan","Guinean","Guyanese","Haitian","Herzegovinian","Honduran","Hungarian","I-Kiribati","Icelander","Indian","Indonesian","Iranian","Iraqi","Irish","Israeli","Italian","Ivorian","Jamaican","Japanese","Jordanian","Kazakhstani","Kenyan","Kittian and Nevisian","Kuwaiti","Kyrgyz","Laotian","Latvian","Lebanese","Liberian","Libyan","Liechtensteiner","Lithuanian","Luxembourger","Macedonian","Malagasy","Malawian","Malaysian","Maldivan","Malian","Maltese","Marshallese","Mauritanian","Mauritian","Mexican","Micronesian","Moldovan","Monacan","Mongolian","Moroccan","Mosotho","Motswana","Mozambican","Namibian","Nauruan","Nepalese","New Zealander","Nicaraguan","Nigerian","Nigerien","North Korean","Northern Irish","Norwegian","Omani","Pakistani","Palauan","Panamanian","Papua New Guinean","Paraguayan","Peruvian","Polish","Portuguese","Qatari","Romanian","Russian","Rwandan","Saint Lucian","Salvadoran","Samoan","San Marinese","Sao Tomean","Saudi","Scottish","Senegalese","Serbian","Seychellois","Sierra Leonean","Singaporean","Slovakian","Slovenian","Solomon Islander","Somali","South African","South Korean","Spanish","Sri Lankan","Sudanese","Surinamer","Swazi","Swedish","Swiss","Syrian","Taiwanese","Tajik","Tanzanian","Thai","Togolese","Tongan","Trinidadian or Tobagonian","Tunisian","Turkish","Tuvaluan","Ugandan","Ukrainian","Uruguayan","Uzbekistani","Venezuelan","Vietnamese","Welsh","Yemenite","Zambian","Zimbabwean"];function Ze(e,n){return ge.apply(this,arguments)}function ge(){return ge=(0,N.Z)(F().mark((function e(n,t){var i,a;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(n);case 2:return i=e.sent,e.next=5,i.blob();case 5:return a=e.sent,e.abrupt("return",new File([a],t,{type:"image/jpeg"}));case 7:case"end":return e.stop()}}),e)}))),ge.apply(this,arguments)}t(59250);var je=t(16114),fe=(t(30887),t(28682)),be=t(72709),we=function(){var e=(0,N.Z)(F().mark((function e(){var n;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,be.ns)("/reader-without-fp",{timeout:1e5});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=(0,N.Z)(F().mark((function e(){var n;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,be.tm)("/reader-with-fp",{timeout:1e4});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=t(81473),Ie=e=>{var n=e.title,t=e.buttonSize,i=e.callback,a=(0,Z.useState)(!1),l=(0,p.Z)(a,2),r=l[0],o=l[1],s=function(){var e=(0,N.Z)(F().mark((function e(){var n,t,a,l,r;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we();case 3:n=e.sent,t=null!=(null===n||void 0===n?void 0:n.DOB)?me()(null===n||void 0===n?void 0:n.DOB,"DD/MM/YYYY"):void 0,a=null!=(null===n||void 0===n?void 0:n.Photo)?"data:image/jpeg;base64, ".concat(n.Photo):void 0,l="Others","L"===(null===n||void 0===n?void 0:n.Gender)&&(l="Male"),"P"===(null===n||void 0===n?void 0:n.Gender)&&(l="Female"),r={nricPassport:null===n||void 0===n?void 0:n.ICNo,fullName:null===n||void 0===n?void 0:n.Name,gender:l,birthDate:t,race:null!=(null===n||void 0===n?void 0:n.Race)&&""!==(null===n||void 0===n?void 0:n.Race)?te(null===n||void 0===n?void 0:n.Race):"",address1:null===n||void 0===n?void 0:n.Addr1,address2:null===n||void 0===n?void 0:n.Addr2,address3:"".concat(null===n||void 0===n?void 0:n.Postcode," ").concat(null===n||void 0===n?void 0:n.City),address4:null===n||void 0===n?void 0:n.State,imageString:a},i(r),o(!1),e.next=19;break;case 14:e.prev=14,e.t0=e["catch"](0),console.log(e.t0),M.ZP.error("scan ic error!"),o(!1);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,N.Z)(F().mark((function e(){var n,t,a,l,r,s,u,d,c,v,p,h,m,x,Z,g,j,f,b,w,k,y,I,S,C,T,P;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ke();case 3:n=e.sent,console.log(n),null!=(null===n||void 0===n?void 0:n.Data)&&(S=null!=(null===n||void 0===n||null===(t=n.Data)||void 0===t||null===(a=t.MYKAD)||void 0===a?void 0:a.DOB)?me()(null===n||void 0===n||null===(l=n.Data)||void 0===l||null===(r=l.MYKAD)||void 0===r?void 0:r.DOB,"DD-MM-YYYY"):void 0,C=null!=(null===n||void 0===n||null===(s=n.Data)||void 0===s||null===(u=s.MYKAD)||void 0===u?void 0:u.Photo)?"data:image/jpeg;base64, ".concat(n.Data.MYKAD.Photo):void 0,T="Others","L"===(null===n||void 0===n||null===(d=n.Data)||void 0===d||null===(c=d.MYKAD)||void 0===c?void 0:c.Gender)&&(T="Male"),"P"===(null===n||void 0===n||null===(v=n.Data)||void 0===v||null===(p=v.MYKAD)||void 0===p?void 0:p.Gender)&&(T="Female"),P={nricPassport:null===n||void 0===n||null===(h=n.Data)||void 0===h||null===(m=h.MYKAD)||void 0===m?void 0:m.ICNumber,fullName:null===n||void 0===n||null===(x=n.Data)||void 0===x||null===(Z=x.MYKAD)||void 0===Z?void 0:Z.GMPCName,gender:T,birthDate:S,race:te(null===n||void 0===n||null===(g=n.Data)||void 0===g||null===(j=g.MYKAD)||void 0===j?void 0:j.Race),address1:null===n||void 0===n||null===(f=n.Data)||void 0===f||null===(b=f.MYKAD)||void 0===b?void 0:b.Address1,address2:null===n||void 0===n||null===(w=n.Data)||void 0===w||null===(k=w.MYKAD)||void 0===k?void 0:k.Address2,address3:null===n||void 0===n||null===(y=n.Data)||void 0===y||null===(I=y.MYKAD)||void 0===I?void 0:I.Address3,imageString:C},i(P),o(!1)),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0),M.ZP.error("scan ic error!"),o(!1);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o(!0),"fp"!==n){e.next=6;break}return e.next=4,u();case 4:e.next=8;break;case 6:return e.next=8,s();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),c=()=>{o(!1)},v=(0,I.jsx)(fe.Z,{items:[{label:(0,I.jsx)(b.Z,{type:"text",onClick:()=>d("fp"),children:"With Fingerprint"}),key:"0"},{label:(0,I.jsx)(b.Z,{type:"text",onClick:()=>d(),children:"Without Fringerprint"}),key:"1"}]});return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(je.Z,{overlay:v,trigger:["click"],children:(0,I.jsx)(b.Z,{icon:(0,I.jsx)(ye.Z,{}),size:t,onClick:e=>e.preventDefault(),children:n})}),(0,I.jsx)(h.Z,{title:"Scanning is in progress",width:250,visible:r,footer:null,closable:!1,centered:!0,destroyOnClose:!0,children:(0,I.jsxs)(f.Z,{children:[(0,I.jsx)(ye.Z,{style:{fontSize:100,marginBottom:24}}),(0,I.jsx)(b.Z,{size:"large",danger:!0,onClick:c,children:"Cancel"})]})})]})};Ie.defaultProps={title:void 0,buttonSize:"middle"};var Se=Ie,Ce=ce.Z.Option,Te=e=>{var n=(0,g.I0)(),t=e.callback,i=(0,g.v9)((e=>e.counter)),a=i.counter,l=(0,Z.useState)(!1),r=(0,p.Z)(l,2),o=r[0],s=r[1],u=(0,Z.useState)(!1),m=(0,p.Z)(u,2),x=m[0],j=m[1],f=(0,Z.useState)(!1),w=(0,p.Z)(f,2),k=w[0],y=w[1],S=(0,Z.useState)(),C=(0,p.Z)(S,2),P=C[0],D=C[1],M=de.Z.useForm(),R=(0,p.Z)(M,1),A=R[0],V=()=>{y(!0)},B=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=(null===n||void 0===n?void 0:n.nricPassport)&&""!==(null===n||void 0===n?void 0:n.nricPassport)&&A.setFieldsValue(n),null==(null===n||void 0===n?void 0:n.imageString)||""===(null===n||void 0===n?void 0:n.imageString)){e.next=6;break}return e.next=4,Ze(n.imageString,"profileImage");case 4:t=e.sent,D(t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=()=>{A.resetFields(),s(!1),j(!1),D(void 0)},E=()=>{_(),y(!1),s(!1)},z=function(){var e=(0,N.Z)(F().mark((function e(i){var l,r,o;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s(!0),e.next=3,(0,X.wK)((0,v.Z)((0,v.Z)({},i),{},{birthDate:null===(l=i.birthDate)||void 0===l?void 0:l.format("YYYY-MM-DD"),shopId:null===a||void 0===a||null===(r=a.shopId)||void 0===r?void 0:r._id}));case 3:if(o=e.sent,o.status||null==o._id){e.next=13;break}if(null==P){e.next=8;break}return e.next=8,(0,X.vu)({file:P,customerId:o._id});case 8:return e.next=10,n({type:"customer/setCustomer",payload:o});case 10:null!=t&&t(o),y(!1),_();case 13:s(!1);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();de.Z.Item,ce.Z;return(0,I.jsxs)(T.ZP,{locale:H.Z,children:[(0,I.jsx)(b.Z,{icon:(0,I.jsx)(ve.Z,{}),size:"large",onClick:V,type:"link",children:"Register New Customer"}),(0,I.jsx)(h.Z,{title:"Register New Customer",width:800,onCancel:E,confirmLoading:!0,footer:[(0,I.jsx)(Se,{callback:B,title:"Scan IC"},"scan"),(0,I.jsx)(b.Z,{onClick:E,children:"Cancel"},"back"),(0,I.jsx)(b.Z,{type:"primary",loading:o,onClick:()=>{A.validateFields().then(function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,z(n);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((e=>{console.log("Validate Failed:",e)}))},children:"Register"},"submit")],visible:k,centered:!0,destroyOnClose:!0,children:(0,I.jsx)(de.Z,{form:A,layout:"vertical",name:"register",requiredMark:!1,initialValues:{prefix:"60",birthDate:me()("1990-01-01","YYYY-MM-DD"),nationality:"Malaysian"},children:(0,I.jsxs)(d.Z,{gutter:32,children:[(0,I.jsxs)(c.Z,{span:12,children:[(0,I.jsxs)("div",{style:{marginBottom:8},children:[(0,I.jsx)("p",{children:"Profile Image"}),(0,I.jsx)(se.Z,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,beforeUpload:function(){var e=(0,N.Z)(F().mark((function e(n){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return j(!0),t={maxSizeMB:.6,useWebWorker:!0,fileType:"image/jpeg"},e.next=4,(0,J.Z)(n,t);case 4:return i=e.sent,console.log("compressedFile size ".concat(i.size/1024/1024," MB")),D(i),j(!1),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:P?(0,I.jsx)(ue.Z,{src:URL.createObjectURL(P),alt:"avatar",style:{width:"100%"}}):(0,I.jsxs)("div",{children:[x?(0,I.jsx)(pe.Z,{}):(0,I.jsx)(Y.Z,{}),(0,I.jsx)("div",{style:{marginTop:8},children:"Upload"})]})})]}),(0,I.jsx)(de.Z.Item,{name:"nricPassport",label:"NRIC/Passport",rules:[{required:!0,message:"Please input your NRIC/Passport!"}],children:(0,I.jsx)(oe.Z,{})}),(0,I.jsx)(de.Z.Item,{name:"nricPassport2",label:"NRIC/Passport 2",children:(0,I.jsx)(oe.Z,{})}),(0,I.jsx)(de.Z.Item,{name:"fullName",label:"Full Name",rules:[{required:!0,message:"Please input your Full Name!"}],children:(0,I.jsx)(oe.Z,{})}),(0,I.jsxs)(d.Z,{gutter:8,children:[(0,I.jsx)(c.Z,{span:12,children:(0,I.jsx)(de.Z.Item,{name:"birthDate",label:"Birth Date",rules:[{required:!0,message:"Please select your birth date!"}],children:(0,I.jsx)(re.Z,{style:{width:"100%"},format:"YYYY-MM-DD"})})}),(0,I.jsx)(c.Z,{span:12,children:(0,I.jsx)(de.Z.Item,{name:"gender",label:"Gender",rules:[{required:!0,message:"Please select your gender!"}],children:(0,I.jsxs)(ce.Z,{placeholder:"Select your gender",children:[(0,I.jsx)(Ce,{value:"Male",children:"Male"}),(0,I.jsx)(Ce,{value:"Female",children:"Female"}),(0,I.jsx)(Ce,{value:"Others",children:"Others"})]})})})]})]}),(0,I.jsxs)(c.Z,{span:12,children:[(0,I.jsx)(de.Z.Item,{name:"address1",label:"Address",rules:[{required:!0,message:"Please input your address!"}],children:(0,I.jsx)(oe.Z,{})}),(0,I.jsx)(de.Z.Item,{name:"address2",children:(0,I.jsx)(oe.Z,{})}),(0,I.jsx)(de.Z.Item,{name:"address3",children:(0,I.jsx)(oe.Z,{})}),(0,I.jsx)(de.Z.Item,{name:"address4",children:(0,I.jsx)(oe.Z,{})}),(0,I.jsx)(de.Z.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please input your phone number!"},{min:10,message:"Please input a valid phone number!"}],children:(0,I.jsx)(oe.Z,{})}),(0,I.jsx)(de.Z.Item,{name:"race",label:"Race",rules:[{required:!0,message:"Please select your race!"}],children:(0,I.jsxs)(ce.Z,{placeholder:"Select your race",children:[(0,I.jsx)(Ce,{value:"Melayu",children:"Melayu"}),(0,I.jsx)(Ce,{value:"Cina",children:"Cina"}),(0,I.jsx)(Ce,{value:"Indian",children:"Indian"}),(0,I.jsx)(Ce,{value:"Bumiputera",children:"Bumiputera"}),(0,I.jsx)(Ce,{value:"Non-Warganegara",children:"Non-Warganegara"}),(0,I.jsx)(Ce,{value:"Lain-Lain",children:"Lain-Lain"})]})}),(0,I.jsx)(de.Z.Item,{name:"nationality",label:"Nationality",rules:[{required:!0,message:"Please select your nationality!"}],children:(0,I.jsx)(ce.Z,{placeholder:"Select your nationality",children:xe.map((e=>(0,I.jsx)(Ce,{value:e,children:e},(0,Q.x0)())))})})]})]})})})]})};Te.defaultProps={callback:void 0};var Pe=Te,De=t(21746),Me=t.n(De),Ne=()=>{var e,n=(0,g.I0)(),t=(0,Z.useRef)([]),i=(0,g.v9)((e=>e.transaction)),a=i.cartItems,o=(0,g.v9)((e=>e.counter)),s=o.counter,d=(0,g.v9)((e=>e.config)),c=d.config,m=(0,g.v9)((e=>e.customer)),x=m.customer,f=m.customers,w=(0,g.v9)((e=>e.config)),k=w.pawnConditions,y=w.goldTypes,S=w.jewelleryTypes,C=(0,Z.useState)(),R=(0,p.Z)(C,2),te=R[0],ae=R[1],re=(0,Z.useState)(!1),oe=(0,p.Z)(re,2),se=oe[0],ue=oe[1],de=(0,Z.useState)(!1),ce=(0,p.Z)(de,2),ve=ce[0],pe=ce[1],he=(0,Z.useState)(!1),me=(0,p.Z)(he,2),xe=me[0],Ze=me[1],ge=(0,Z.useState)(!1),je=(0,p.Z)(ge,2),fe=je[0],be=je[1],we=(0,Z.useState)(!1),ke=(0,p.Z)(we,2),ye=(ke[0],ke[1]),Ie=(0,Z.useState)([]),Ce=(0,p.Z)(Ie,2),Te=Ce[0],De=Ce[1],Ne=(0,Z.useState)(""),Re=(0,p.Z)(Ne,2),Fe=Re[0],Ae=Re[1],Ve=(0,j.Nr)(Fe,800),Ye=(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:5},sortOrder:"desc",sortField:"updatedAt",search:{},filters:{shopId:null===s||void 0===s||null===(e=s.shopId)||void 0===e?void 0:e._id}}}),[null===s||void 0===s||null===(e=s.shopId)||void 0===e?void 0:e._id]),Be=["-","Civil / Government Employee / Kakitangan Awam / Kerajaan","Office Job / Pekerjaan Di Pejabat","Driver / Pemandu","Sales / Penjualan","Factory Work / Perkerjaan Di Kilang","Housewife / Child Care / Suri Rumah / Peniagaan Anak","Student / Pelaiar","Retired / Bersara","Self Employed / Kerja Sendiri","Unemployed / Penganggur","Others"],_e=["-","Family Support / Living Expenses Sokongan Keluarga / Perbelanjaan Sara Hidup","Saving/Investments / Simpanan / Pelaburan","Gift / Hadiah","Goods & Services Payment / Bayaran barangan & Perkhidmatan","Travel Expenses / Perbelanjaan Perialanan","Education Fee / Yuran Pendidikan","Rent / Mortgage / Sewa/Gadai janji","Emergency / Medical Aid / Bantuan Keemasan / Perubatan","Charity / Aid Payment / Bayaran Amal / Bantuan","Emplovee Expenses / Perbelaniaan Pekeria","Other"],Ee=["-","Government Sector / Sektor Kerajaan","Military Sector / Sektor ketenteraan","International Sector / Sektor Antarabangsa","Private Sector / Sektor Swasta","Technology Sector / Sektor Teknologi","Merchandising Sector / Sektor Perniagan","Service Sector / Sektor Perkhidmatan","Manufacturing Sector / Sektor Perkilangan","Non-profit Sector / Sektor Tapa Keuntungan","Public Sector / Sektor Awam","Other"];(0,j.Dp)((()=>{n({type:"config/getGoldTypes"}),n({type:"config/getPawnConditions"}),n({type:"config/getJewelleryTypes"})}));var ze=e=>{ye(!0);var i=[...f,e];n({type:"customer/setCustomers",payload:{customers:i,total:i.length}}),t.current.forEach((n=>{var t;null===(t=n.current)||void 0===t||t.setFieldsValue({customerId:e._id})})),ye(!1)},We=function(){var e=(0,N.Z)(F().mark((function e(t){var i,l,r,o,s;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return pe(!0),i=null!=(null===c||void 0===c?void 0:c.handlingFee)?null===c||void 0===c?void 0:c.handlingFee:0,l=0-+t.principalValue+i,e.next=5,Promise.all(Te.map(function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,J.Z.getDataUrlFromFile(n);case 2:return t=e.sent,e.abrupt("return",t.replace(/^data:image\/[a-z]+;base64,/,""));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 5:return r=e.sent,e.next=8,(0,X.jy)(t.customerId);case 8:return o=e.sent,n({type:"customer/setCustomer",payload:o}),s={actionType:ee.NEW,customer:o,transactionDetails:{customerId:t.customerId,principalValue:t.principalValue,interest:100,interestPackageId:t.interestPackageId,totalWeight:t.totalWeight,customerOccupation:t.customerOccupation,transferPurpose:t.transferPurpose,customerEmployerName:t.customerEmployerName,customerEmployerNature:t.customerEmployerNature,pawnType:t.pawnType,pawnItems:"Gold"===t.pawnType?t.goldPawnItems:t.otherPawnItems,totalToPay:l,netValue:l,imageFiles:r}},a.push(s),e.next=14,le().setItem(ne.qW,a);case 14:return e.next=16,n({type:"transaction/setCartItems",payload:a});case 16:return ue(!1),De([]),M.ZP.success("Added to Cart"),pe(!1),e.abrupt("return",!0);case 21:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Le=()=>(ue(!1),Ze(!1),pe(!1),De([]),!0),Oe=e=>{n({type:"customer/getCustomers",params:e})},qe=e=>{var t=[...f,e];n({type:"customer/setCustomers",payload:{customers:t,total:t.length}})},Ge=function(){var e=(0,N.Z)(F().mark((function e(t){var i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==(null===t||void 0===t?void 0:t.nricPassport)||""===(null===t||void 0===t?void 0:t.nricPassport)){e.next=17;break}return Ae(t.nricPassport),e.prev=2,e.next=5,(0,X.OL)((0,v.Z)((0,v.Z)({},Ye),{},{searchCustomer:t.nricPassport,pagination:{pageSize:1}}));case 5:return i=e.sent,e.next=8,n({type:"customer/setCustomers",payload:i});case 8:if(null==i.customers[0]){e.next=11;break}return e.next=11,n({type:"customer/setCustomer",payload:i.customers[0]});case 11:e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](2),console.log(e.t0),M.ZP.error("scan ic callback error!");case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(n){return e.apply(this,arguments)}}(),Ke=(0,Z.useState)({fetchCustomers:Oe,setCustomers:qe}),Ue=(0,p.Z)(Ke,1),He=Ue[0];(0,Z.useEffect)((()=>{var e=!1;return Ve&&!e&&He.fetchCustomers((0,v.Z)((0,v.Z)({},Ye),{},{search:{nricPassport:Ve}})),null==(null===t||void 0===t?void 0:t.current)||null==x||e||(be(!0),He.setCustomers(x),t.current.forEach((e=>{var n;null===(n=e.current)||void 0===n||n.setFieldsValue({customerId:null===x||void 0===x?void 0:x._id})})),be(!1)),()=>{e=!0}}),[Ve,He,Ye,x]);var Je=(e,n)=>(0,I.jsx)(b.Z,{type:"text",icon:(0,I.jsx)(A.Z,{}),danger:!0,onClick:()=>{n.remove(e.name)}},"delete"),Qe=(e,n)=>{var t=e.listDom,i=e.action;n.record;return(0,I.jsx)(B.ZP,{bordered:!0,extra:i,title:"Pawn Item",style:{marginBottom:8},children:t})};return(0,I.jsxs)(T.ZP,{locale:H.Z,children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(V.Z,{}),className:Me().bigButton,onClick:()=>ue(!0),children:"Pawn New Item"}),(0,I.jsx)(h.Z,{title:"Pawn New Item",width:888,onCancel:Le,visible:se,footer:null,destroyOnClose:!0,maskClosable:!1,children:(0,I.jsxs)(E.L,{onFinish:We,formMapRef:t,formProps:{validateMessages:{required:"Required!"}},submitter:{render:e=>0===e.step?(0,I.jsxs)("div",{style:{width:520},children:[(0,I.jsx)(D.Z,{style:{margin:" 0 0 12px 0"}}),(0,I.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,I.jsx)(b.Z,{type:"primary",size:"large",onClick:()=>{var n;return null===(n=e.onSubmit)||void 0===n?void 0:n.call(e)},children:"Next"})})]}):1===e.step?[(0,I.jsxs)("div",{style:{width:612},children:[(0,I.jsx)(D.Z,{style:{margin:" 0 0 12px 0"}}),(0,I.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,I.jsxs)(r.Z,{children:[(0,I.jsx)(b.Z,{size:"large",onClick:()=>{var n;return null===(n=e.onPre)||void 0===n?void 0:n.call(e)},children:"Back"},"pre"),(0,I.jsx)(b.Z,{type:"primary",size:"large",onClick:()=>{var n;return null===(n=e.onSubmit)||void 0===n?void 0:n.call(e)},children:"Next"})]})})]},(0,Q.x0)())]:[(0,I.jsxs)("div",{style:{width:612},children:[(0,I.jsx)(D.Z,{style:{margin:" 0 0 12px 0"}}),(0,I.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,I.jsxs)(r.Z,{children:[(0,I.jsx)(b.Z,{size:"large",disabled:ve,onClick:()=>{var n;return null===(n=e.onPre)||void 0===n?void 0:n.call(e)},children:"Back"},"gotoTwo"),(0,I.jsx)(b.Z,{type:"primary",size:"large",loading:ve,onClick:()=>{var n;return null===(n=e.onSubmit)||void 0===n?void 0:n.call(e)},children:"Confirm"},"goToTree")]})})]},(0,Q.x0)())]},children:[(0,I.jsxs)(E.L.StepForm,{name:"overview",title:"Overview",initialValues:{customerId:null===x||void 0===x?void 0:x._id},children:[fe?(0,I.jsx)(P.Z,{paragraph:{rows:1},active:!0}):(0,I.jsxs)(r.Z,{children:[(0,I.jsx)(z.Z,{name:"customerId",label:"Customer",showSearch:!0,width:520,debounceTime:800,fieldProps:{onSearch:e=>{var n;null!=e&&""!==e&&Oe({filters:{shopId:null===s||void 0===s||null===(n=s.shopId)||void 0===n?void 0:n._id},searchCustomer:e})},notFoundContent:fe?(0,I.jsx)(l.Z,{}):(0,I.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE,description:"Customer not found"})},options:ie(null===f||void 0===f?void 0:f.map((e=>{var n,t;return{value:null!==(n=e._id)&&void 0!==n?n:"-",label:null!==(t="".concat(e.fullName," (").concat(e.nricPassport,")"))&&void 0!==t?t:"-"}}))),placeholder:"Enter NRIC",rules:[{required:!0,message:"Please select a customer"}],extra:(0,I.jsx)(Pe,{callback:ze})}),(0,I.jsx)("div",{style:{marginTop:-33},children:(0,I.jsx)(Se,{callback:Ge})})]}),(0,I.jsxs)(_.ZP.Group,{children:[(0,I.jsx)(W.Z,{label:"Principle Value",name:"principalValue",locale:"ms-MY",min:1,width:"sm",placeholder:"Input money to borrow",rules:[{required:!0,message:"Please enter a value for item principle"}]}),xe?(0,I.jsx)("div",{style:{width:300},children:(0,I.jsx)(P.Z,{paragraph:{rows:1},active:!0})}):(0,I.jsx)(z.Z,{label:"Interest Packages",name:"interestPackageId",rules:[{required:!0}],width:270,placeholder:"Select a package",initialValue:te,request:(0,N.Z)(F().mark((function e(){var n,t,i,a,l,r,o,u;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ze(!0),null==(null===s||void 0===s||null===(n=s.shopId)||void 0===n?void 0:n._id)){e.next=11;break}return e.next=4,(0,$.f)(null===s||void 0===s||null===(t=s.shopId)||void 0===t?void 0:t._id);case 4:return l=e.sent,r=null!==(i=null===l||void 0===l?void 0:l.interestPackages)&&void 0!==i?i:[],o=null==r?null:null===(a=r.find((e=>"Default Package"===e.interestDescription)))||void 0===a?void 0:a._id,ae(o),u=null===r||void 0===r?void 0:r.map((e=>{var n,t;return{value:null!==(n=e._id)&&void 0!==n?n:"-",label:null!==(t=e.interestDescription)&&void 0!==t?t:"-"}})),Ze(!1),e.abrupt("return",u);case 11:return Ze(!1),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})))})]}),(0,I.jsx)(L.Z,{name:["principalValue"],children:e=>{var n=e.principalValue;return n>=3e3?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(D.Z,{orientation:"left",orientationMargin:0,children:"Additional information for high value pawn (More than RM3000)"}),(0,I.jsx)(z.Z,{name:"customerOccupation",label:"Customer's Occupation",rules:[{required:!0}],placeholder:"Occupation",options:null===Be||void 0===Be?void 0:Be.map((e=>({value:null!==e&&void 0!==e?e:"-",label:null!==e&&void 0!==e?e:"-"})))}),(0,I.jsx)(z.Z,{name:"transferPurpose",label:"Customer's Purpose of Transfer",rules:[{required:!0}],placeholder:"Purpose of Transfer",options:null===_e||void 0===_e?void 0:_e.map((e=>({value:null!==e&&void 0!==e?e:"-",label:null!==e&&void 0!==e?e:"-"})))}),(0,I.jsx)(O.Z,{name:"customerEmployerName",placeholder:"Name of Employer",label:"Name of Customer's Employer",rules:[{required:!0}]}),(0,I.jsx)(z.Z,{name:"customerEmployerNature",label:"Nature of Customer's Employer",rules:[{required:!0}],placeholder:"Nature of Employer",options:null===Ee||void 0===Ee?void 0:Ee.map((e=>({value:null!==e&&void 0!==e?e:"-",label:null!==e&&void 0!==e?e:"-"})))})]}):null}})]}),(0,I.jsxs)(E.L.StepForm,{name:"Items",title:"Pawn Items",children:[(0,I.jsxs)(_.ZP.Group,{children:[(0,I.jsx)(z.Z,{label:"Pawn Type",name:"pawnType",rules:[{required:!0}],width:"sm",placeholder:"Select pawn item type",initialValue:"Gold",options:[{value:"Gold",label:"Gold"},{value:"Other",label:"Other"}]}),(0,I.jsx)(L.Z,{name:["pawnType"],children:e=>{var n=e.pawnType;return"Gold"===n?(0,I.jsx)(q.Z,{name:"totalWeight",label:"Total Weight (gram)",min:0,width:"sm",placeholder:"",rules:[{required:!0}]}):null}})]}),(0,I.jsx)(L.Z,{name:["pawnType"],children:e=>{var n=e.pawnType;return"Gold"===n?(0,I.jsx)(G.u,{name:"goldPawnItems",creatorButtonProps:{creatorButtonText:"Add Gold"},actionRender:(e,n)=>[Je(e,n)],itemRender:Qe,initialValue:[{quantity:1,pawnCondition:"-"}],children:function(e,n,t){var i;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(K.UW,{children:[(0,I.jsx)(O.Z,{name:"remarks",placeholder:"Special request",label:"Remarks"}),(0,I.jsx)(O.Z,{name:"description",placeholder:"Description of the item",label:"Description"})]}),(0,I.jsxs)(K.UW,{children:[(0,I.jsx)(q.Z,{name:"quantity",label:"Quantity",min:0,placeholder:"0",width:"xs",rules:[{required:!0}]}),(0,I.jsx)(z.Z,{label:"Jewellery Type",name:"jewelleryType",placeholder:"Select",rules:[{required:!0}],width:240,options:ie(null===S||void 0===S||null===(i=S.filter((e=>"Gold"===e.pawnType)))||void 0===i?void 0:i.map((e=>({value:e.shortCode,label:e.codeDescription}))))}),(0,I.jsx)(z.Z,{label:"Gold Type",name:"goldType",placeholder:"Select",width:160,rules:[{required:!0}],options:ie(null===y||void 0===y?void 0:y.map((e=>({value:e.shortCode,label:e.codeDescription}))))}),(0,I.jsx)(z.Z,{label:"Condition",name:"pawnCondition",placeholder:"Select",width:160,rules:[{required:!0}],options:ie(null===k||void 0===k?void 0:k.map((e=>({value:e.shortCode,label:e.codeDescription}))))})]})]})}}):(0,I.jsx)(G.u,{name:"otherPawnItems",creatorButtonProps:{creatorButtonText:"Add Item"},actionRender:(e,n)=>[Je(e,n)],itemRender:Qe,initialValue:[{quantity:1}],children:function(e,n,t){var i;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(K.UW,{children:[(0,I.jsx)(O.Z,{name:"remarks",placeholder:"Special request",label:"Remarks"}),(0,I.jsx)(O.Z,{name:"description",placeholder:"Description of the item",label:"Description"})]}),(0,I.jsxs)(K.UW,{children:[(0,I.jsx)(q.Z,{name:"quantity",label:"Quantity",min:1,placeholder:"1",width:"xs",rules:[{required:!0}]}),(0,I.jsx)(z.Z,{label:"Jewellery Type",name:"jewelleryType",placeholder:"Select",rules:[{required:!0}],width:202,options:ie(null===S||void 0===S||null===(i=S.filter((e=>"Other"===e.pawnType)))||void 0===i?void 0:i.map((e=>({value:e.shortCode,label:e.codeDescription}))))}),(0,I.jsx)(z.Z,{label:"Condition",name:"pawnCondition",placeholder:"Select",width:202,rules:[{required:!0}],options:ie(null===k||void 0===k?void 0:k.map((e=>({value:e.shortCode,label:e.codeDescription}))))})]})]})}})}})]}),(0,I.jsx)(E.L.StepForm,{name:"itemPhotos",title:"Item Photos",children:(0,I.jsx)("div",{style:{width:612,display:"flex",justifyContent:"center"},children:(0,I.jsx)(U.Z,{name:"imageFiles",label:"",icon:(0,I.jsx)(Y.Z,{}),title:"Add Photo",max:10,rules:[{required:!0}],fieldProps:{listType:"picture-card",onRemove:e=>{var n=Te.indexOf(e),t=Te.slice();t.splice(n,1),De(t)},beforeUpload:function(){var e=(0,N.Z)(F().mark((function e(n){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={maxSizeMB:.3,useWebWorker:!0,fileType:"image/jpeg"},e.next=3,(0,J.Z)(n,t);case 3:return i=e.sent,console.log("compressedFile size ".concat(i.size/1024/1024," MB")),De([...Te,i]),e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()}})})})]})})]})},Re=Ne,Fe=t(92911),Ae=t(76570),Ve=t(8812),Ye=t(37217),Be=t.n(Ye),_e=(t(22385),t(61580)),Ee=t(23538),ze=t(77283),We=e=>{var n=e.callback,t=(0,Z.useState)(!1),i=(0,p.Z)(t,2),a=i[0],l=i[1],r=(0,Z.useState)(1e3),o=(0,p.Z)(r,1),s=o[0],u=(0,Z.useState)("No result"),d=(0,p.Z)(u,2),c=(d[0],d[1]),v=()=>{l(!0)},m=()=>{l(!1)},x=(e,t)=>{null!=(null===e||void 0===e?void 0:e.text)&&(c(null===e||void 0===e?void 0:e.text),n(null===e||void 0===e?void 0:e.text),l(!1))};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(_e.Z,{title:"Scan QR",children:(0,I.jsx)(b.Z,{icon:(0,I.jsx)(Ee.Z,{}),size:"large",style:{width:"40px"},onClick:v})}),(0,I.jsx)(h.Z,{title:"QR Scanning",width:400,visible:a,footer:null,onCancel:m,centered:!0,destroyOnClose:!0,children:(0,I.jsx)(ze.T,{scanDelay:s,onResult:x,constraints:{facingMode:"environment"}})})]})},Le=We,Oe=ce.Z.Option,qe=m.Z.Text,Ge=e=>{var n,t,o,s,u=(0,g.I0)(),d=(0,g.v9)((e=>e.loading.models.ticket)),c=((0,g.v9)((e=>e.loading.models.customer)),(0,g.v9)((e=>e.counter))),m=c.counter,x=(0,Z.useState)(!1),w=(0,p.Z)(x,2),k=w[0],y=w[1],S=(0,Z.useState)(!1),C=(0,p.Z)(S,2),T=C[0],D=C[1],R=(0,Z.useState)({pawnTickets:[],total:0}),A=(0,p.Z)(R,2),V=A[0],Y=A[1],B=(0,Z.useState)({customers:[],total:0}),_=(0,p.Z)(B,2),E=_[0],z=_[1],W=(0,Z.useState)("pawnNo"),L=(0,p.Z)(W,2),O=L[0],q=L[1],G=(0,Z.useState)(""),K=(0,p.Z)(G,2),U=K[0],H=K[1],J=(0,j.Nr)(O,800),Q=(0,j.Nr)(U,800),$=(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:5},sortOrder:"desc",sortField:"createdAt",search:{},filters:{shopId:null===m||void 0===m||null===(e=m.shopId)||void 0===e?void 0:e._id}}}),[null===m||void 0===m||null===(n=m.shopId)||void 0===n?void 0:n._id]),ee=(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:5},sortOrder:"desc",sortField:"createdAt",searchCustomer:"",search:{},filters:{shopId:null===m||void 0===m||null===(e=m.shopId)||void 0===e?void 0:e._id}}}),[null===m||void 0===m||null===(t=m.shopId)||void 0===t?void 0:t._id]),ne=(0,Z.useState)(ee),te=(0,p.Z)(ne,2),ie=te[0],ae=te[1],le=(0,Z.useState)($),re=(0,p.Z)(le,2),se=re[0],ue=re[1],de=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,e.next=4,(0,Fe.SP)(n);case 4:t=e.sent,Y(t),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),M.ZP.error("error occurred!");case 11:D(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),ve=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,e.next=4,(0,X.OL)(n);case 4:t=e.sent,z(t),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),M.ZP.error("error occurred!");case 11:D(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),pe=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ve((0,v.Z)((0,v.Z)({},ie),{},{searchCustomer:Q,pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 2:ae((0,v.Z)((0,v.Z)({},ie),{},{searchCustomer:Q,pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),he={simple:!0,total:E.total,showSizeChanger:!0,onChange:function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,pe(n);case 2:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}(),showTotal:(e,n)=>"".concat(n[0],"-").concat(n[1]," of ").concat(e," items"),current:ie.pagination.current,pageSize:ie.pagination.pageSize},xe=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,de((0,v.Z)((0,v.Z)({},se),{},{search:{[J]:Q},pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 2:ue((0,v.Z)((0,v.Z)({},se),{},{search:{[J]:Q},pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ze={simple:!0,total:V.total,showSizeChanger:!0,onChange:function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,xe(n);case 2:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}(),showTotal:(e,n)=>"".concat(n[0],"-").concat(n[1]," of ").concat(e," items"),current:se.pagination.current,pageSize:se.pagination.pageSize},ge=(0,Z.useState)({fetchTickets:de,fetchCustomers:ve}),je=(0,p.Z)(ge,1),fe=je[0];(0,Z.useEffect)((()=>{var e=!1;return null==Q||""===Q||e||("customer"===J&&fe.fetchCustomers((0,v.Z)((0,v.Z)({},ee),{},{searchCustomer:Q})),"pawnNo"===J&&fe.fetchTickets((0,v.Z)((0,v.Z)({},$),{},{search:{[J]:Q}}))),()=>{e=!0}}),[J,Q,fe,ee,$]);var be=()=>{y(!0)},we=()=>{y(!1)},ke=e=>{H(e.target.value)},ye=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u({type:"ticket/setTicket",payload:n});case 2:if(null==(null===n||void 0===n||null===(t=n.pawnTicketsSubId)||void 0===t?void 0:t.customerId)){e.next=5;break}return e.next=5,u({type:"customer/setCustomer",payload:n.pawnTicketsSubId.customerId});case 5:we();case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ie=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u({type:"customer/setCustomer",payload:n});case 2:we();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ce=function(){var e=(0,N.Z)(F().mark((function e(n){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==n||""===n){e.next=19;break}return D(!0),H(n),e.prev=3,e.next=6,(0,Fe.SP)((0,v.Z)((0,v.Z)((0,v.Z)({},$),se),{},{filters:{shopId:null===m||void 0===m||null===(t=m.shopId)||void 0===t?void 0:t._id},search:{pawnNo:n},pagination:{pageSize:1}}));case 6:if(i=e.sent,null==i.pawnTickets[0]){e.next=12;break}return e.next=10,ye(i.pawnTickets[0]);case 10:e.next=13;break;case 12:Y(i);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](3),M.ZP.error("error occurred!");case 18:D(!1);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(n){return e.apply(this,arguments)}}(),Te=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(D(!0),null==(null===n||void 0===n?void 0:n.nricPassport)||""===(null===n||void 0===n?void 0:n.nricPassport)){e.next=19;break}return H(n.nricPassport),e.prev=3,e.next=6,(0,X.OL)((0,v.Z)((0,v.Z)((0,v.Z)({},ee),ie),{},{searchCustomer:n.nricPassport,pagination:{pageSize:1}}));case 6:if(t=e.sent,null==t.customers[0]){e.next=12;break}return e.next=10,Ie(t.customers[0]);case 10:e.next=13;break;case 12:z(t);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](3),console.log(e.t0),M.ZP.error("scan ic callback error!");case 19:D(!1);case 20:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(n){return e.apply(this,arguments)}}();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(Ae.Z,{}),className:Be().bigButton,onClick:be,children:"Search"}),(0,I.jsx)(h.Z,{title:"Search",width:600,visible:k,footer:null,okText:"Search",onCancel:we,centered:!0,destroyOnClose:!0,children:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{style:{marginTop:-16,marginBottom:16},children:(0,I.jsxs)(r.Z,{children:[(0,I.jsxs)(oe.Z.Group,{compact:!0,children:[(0,I.jsxs)(ce.Z,{defaultValue:O,size:"large",style:{width:"180px"},onChange:q,children:[(0,I.jsx)(Oe,{value:"customer",children:"Customer"}),(0,I.jsx)(Oe,{value:"pawnNo",children:"Pawn No"})]}),(0,I.jsx)(oe.Z,{style:{width:320,height:40},size:"large",onChange:ke,value:U})]}),"pawnNo"===O?(0,I.jsx)(Le,{callback:Ce}):(0,I.jsx)(Se,{buttonSize:"large",callback:Te})]})}),(0,I.jsx)(a.Z,{title:"Search Result",size:"small",bordered:!1,children:"pawnNo"===O?(0,I.jsx)(l.Z,{tip:"Loading...",spinning:T||d||!1,children:(0,I.jsx)(i.ZP,{pagination:Ze,dataSource:null!==(o=V.pawnTickets)&&void 0!==o?o:[],renderItem:e=>{var n;return(0,I.jsx)(i.ZP.Item,{actions:[(0,I.jsx)(b.Z,{type:"text",icon:(0,I.jsx)(Ve.Z,{}),onClick:()=>ye(e)})],children:(0,I.jsxs)(P.Z,{title:!1,loading:!1,active:!0,children:[(0,I.jsx)("div",{children:(0,I.jsx)(qe,{type:null!=(null===e||void 0===e?void 0:e.interestMonthCount)&&(null===e||void 0===e?void 0:e.interestMonthCount)>6?"danger":void 0,children:null!==(n=null===e||void 0===e?void 0:e.pawnNo)&&void 0!==n?n:"-"})}),(0,I.jsxs)("div",{children:["RM ",e.principalValue]}),(0,I.jsx)("div",{children:me()(e.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)("div",{children:e.pawnTicketStatus})]})})}})}):(0,I.jsx)(l.Z,{tip:"Loading...",spinning:T,children:(0,I.jsx)(i.ZP,{footer:(0,I.jsx)(f.Z,{children:(0,I.jsx)(Pe,{callback:Ie})}),pagination:he,dataSource:null!==(s=E.customers)&&void 0!==s?s:[],renderItem:e=>(0,I.jsx)(i.ZP.Item,{actions:[(0,I.jsx)(b.Z,{type:"text",icon:(0,I.jsx)(Ve.Z,{}),onClick:()=>Ie(e)})],children:(0,I.jsxs)(P.Z,{title:!1,loading:!1,active:!0,children:[(0,I.jsx)("div",{children:e.nricPassport}),(0,I.jsx)("div",{children:e.fullName})]})})})})})]})})]})},Ke=Ge,Ue=(t(71153),t(60331)),He=(t(38979),t(59466)),Je=(t(77883),t(70507)),Qe=(t(66126),t(99177)),Xe=t(20924);function $e(e,n){var t=new Date(e),i=t.getDate();return t.setMonth(t.getMonth()+n),t.getDate()!==i&&t.setDate(0),t}var en=t(76063),nn=t.n(en),tn=m.Z.Text,an=m.Z.Title,ln=e=>{var n,t,i,a=e.ticket,l=e.customer,r=e.callback,s=de.Z.useForm(),u=(0,p.Z)(s,1),v=u[0],m=(0,g.I0)(),x=(0,g.v9)((e=>e.transaction.cartItems)),f=1,w=(null===a||void 0===a?void 0:a.interestValue)||0,k=null==(null===a||void 0===a?void 0:a.dueDate)?"-":$e(a.dueDate,f),y=(0,Z.useState)(!1),S=(0,p.Z)(y,2),C=S[0],T=S[1],P=(0,Z.useState)(f),R=(0,p.Z)(P,2),A=R[0],V=R[1],Y=(0,Z.useState)(k),B=(0,p.Z)(Y,2),_=B[0],E=B[1],z=(0,Z.useState)(w),W=(0,p.Z)(z,2),L=W[0],O=W[1],q=(0,Z.useState)(L),G=(0,p.Z)(q,2),K=G[0],U=G[1],H=(0,Z.useState)(1),J=(0,p.Z)(H,2),Q=J[0],X=J[1],$=(0,j.Nr)(Q,800),te=()=>{T(!0)},ie=()=>{T(!1)},ae=e=>{X(e)},re=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={actionType:ee.EXTEND,customer:l,ticket:a,transactionDetails:{pawnTicketId:null===a||void 0===a?void 0:a._id,extendMonthCount:A,transactionDate:me()().toISOString(),extendedDueDate:me()(_).toISOString(),paid:L,totalToPay:L}},!x.find((e=>{var n;return(null===e||void 0===e||null===(n=e.transactionDetails)||void 0===n?void 0:n.pawnTicketId)===t.transactionDetails.pawnTicketId}))){e.next=5;break}M.ZP.error("Ticket already in cart"),e.next=12;break;case 5:return x.push(t),e.next=8,le().setItem(ne.qW,x);case 8:m({type:"transaction/setCartItems",payload:x}),ie(),M.ZP.success("Added to Cart"),r();case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,Z.useEffect)((()=>{var e=!1;if($&&!e){var n=function(){var e=(0,N.Z)(F().mark((function e(n){var t,i,l,r;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=null===a||void 0===a?void 0:a.dueDate,null!=t){e.next=5;break}M.ZP.error("This is an error message"),e.next=17;break;case 5:if(i=$e(t,n),e.t0=null!=(null===a||void 0===a?void 0:a.interestPackageId),!e.t0){e.next=11;break}return e.next=10,(0,Fe.s3)({interestPackageId:a.interestPackageId,monthCount:n});case 10:e.t0=e.sent;case 11:l=e.t0,r=null!=(null===l||void 0===l?void 0:l.interestRate)&&null!=(null===a||void 0===a?void 0:a.principalValue)&&l.interestRate/100*a.principalValue||0,V(n),O(r),U(r),E(i);case 17:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();n($).catch(console.error)}return()=>{e=!0}}),[$,null===a||void 0===a?void 0:a.dueDate,null===a||void 0===a?void 0:a.interestPackageId,null===a||void 0===a?void 0:a.principalValue]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(Xe.Z,{}),className:nn().actionButton,onClick:te,disabled:"Renewed"===(null===a||void 0===a?void 0:a.pawnTicketStatus)||"Revalued"===(null===a||void 0===a?void 0:a.pawnTicketStatus)||"Redeemed"===(null===a||void 0===a?void 0:a.pawnTicketStatus)||"Void"===(null===a||void 0===a?void 0:a.pawnTicketStatus)||"Sold"===(null===a||void 0===a?void 0:a.pawnTicketStatus),children:"Extend"}),(0,I.jsxs)(h.Z,{title:"Extend (Pawn No: ".concat(null===a||void 0===a?void 0:a.pawnNo,")"),visible:C,width:600,footer:null,onCancel:ie,centered:!0,destroyOnClose:!0,children:[null==a?null:(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===a||void 0===a?void 0:a.dueDate)?"-":me()(a.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Principle (RM)",children:null==(null===a||void 0===a?void 0:a.principalValue)?"-":a.principalValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===a||void 0===a?void 0:a.createdAt)?"-":me()(a.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===a||void 0===a?void 0:a.createdAt)?"-":me()(a.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(tn,{type:null!=(null===a||void 0===a?void 0:a.interestMonthCount)&&(null===a||void 0===a?void 0:a.interestMonthCount)>6?"danger":void 0,children:null!=(null===a||void 0===a?void 0:a.interestMonthCount)?a.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===a||void 0===a||null===(n=a.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(a.pawnTicketsSubId.totalWeight,"g")})]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(de.Z,{form:v,name:"basic",labelCol:{span:10},wrapperCol:{span:24},onFinish:re,autoComplete:"off",children:[(0,I.jsx)(de.Z.Item,{name:"monthToPay",label:"Month",children:(0,I.jsxs)(d.Z,{children:[(0,I.jsx)(c.Z,{span:12,children:(0,I.jsx)(Qe.Z,{min:1,max:null!==(t=null===a||void 0===a?void 0:a.interestMonthCount)&&void 0!==t?t:1,onChange:ae,value:Q})}),(0,I.jsx)(c.Z,{span:4,children:(0,I.jsx)(Je.Z,{min:1,max:null!==(i=null===a||void 0===a?void 0:a.interestMonthCount)&&void 0!==i?i:1,style:{margin:"0 16px"},value:Q,onChange:ae})})]})}),(0,I.jsx)(de.Z.Item,{label:"Interest to Pay:",children:(0,I.jsxs)(tn,{children:["RM ",L.toFixed(2)]})}),(0,I.jsx)(de.Z.Item,{label:"Extended Due Date:",children:me()(_).format("DD/MM/YYYY")}),(0,I.jsx)(de.Z.Item,{label:"Net Total:",children:(0,I.jsxs)(an,{level:4,type:"success",style:{marginBottom:0},children:["RM ",K.toFixed(2)]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:ie,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:nn().submit,type:"primary",htmlType:"submit",children:"Add to Cart"})})]})]})]})]})},rn=ln,on=(t(62350),t(75443)),sn=t(88633),un=t(49539),dn=t(95657),cn=t.n(dn),vn=e=>{var n=e.ticket,t=e.customer,i=(e.callback,(0,g.v9)((e=>e.counter))),a=i.counter,l=(0,Z.useState)(!1),r=(0,p.Z)(l,2),o=r[0],s=r[1],u=(0,Z.useState)(),d=(0,p.Z)(u,2),c=d[0],v=d[1],h=(0,Z.useState)(!1),m=(0,p.Z)(h,2),x=m[0],j=m[1],f=function(){var e=(0,N.Z)(F().mark((function e(){var i,l,r,o;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s(!0),l={returnFile:"false",customerId:null===t||void 0===t?void 0:t._id,shopId:null===a||void 0===a||null===(i=a.shopId)||void 0===i?void 0:i._id,pawnTickets:null!=(null===n||void 0===n?void 0:n._id)?[n._id]:[]},e.prev=2,e.next=5,(0,Fe.xA)(l);case 5:if(r=e.sent,!1!==r.ok){e.next=10;break}return M.ZP.error("error"),s(!1),e.abrupt("return",!1);case 10:return o=new Blob([new Uint8Array(Object.values(r)).buffer],{type:"application/pdf"}),v(o),c&&j(!0),s(!1),e.abrupt("return",!0);case 17:return e.prev=17,e.t0=e["catch"](2),s(!1),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=(0,N.Z)(F().mark((function e(){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:j(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=()=>{j(!1)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(on.Z,{title:"Are you sure to report lost on this ticket?",okButtonProps:{loading:o},onConfirm:w,onCancel:k,okText:"Yes",cancelText:"No",children:(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(sn.Z,{}),className:cn().actionButton,disabled:"Renewed"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Revalued"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Redeemed"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Void"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Sold"===(null===n||void 0===n?void 0:n.pawnTicketStatus),children:"Lost Report"})}),(0,I.jsx)(un.Z,{buttonTitle:"Print Lost Report",modalTitle:"Print Lost Report Priview",showModal:x,file:c,showTrigger:!1,onClose:k})]})},pn=vn,hn=t(7945),mn=t(46888),xn=t.n(mn),Zn=e=>{var n=(0,g.I0)(),t=e.ticket,i=(0,g.v9)((e=>e.counter)),a=i.counter,l=(0,g.v9)((e=>e.user)),r=l.currentUser,o=(0,g.v9)((e=>e.config)),s=o.printTicketSetting,u=(0,Z.useState)(!1),d=(0,p.Z)(u,2),c=d[0],v=d[1],h=(0,Z.useState)(),m=(0,p.Z)(h,2),x=m[0],f=m[1],w=(0,Z.useState)(!1),k=(0,p.Z)(w,2),y=k[0],S=k[1];(0,j.Dp)((0,N.Z)(F().mark((function e(){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null===a||void 0===a||null===(t=a.shopId)||void 0===t||!t._id){e.next=3;break}return e.next=3,n({type:"config/getPrintTicketSetting",shopId:null===(i=a.shopId)||void 0===i?void 0:i._id});case 3:case"end":return e.stop()}}),e)}))));var C=function(){var e=(0,N.Z)(F().mark((function e(){var n,i,l,o;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c||null===t||void 0===t||!t._id||!s){e.next=10;break}return v(!0),i={shopId:null===a||void 0===a||null===(n=a.shopId)||void 0===n?void 0:n._id,userId:null===r||void 0===r?void 0:r._id,pawnTickets:[null===t||void 0===t?void 0:t._id],showMaxWidth:!1,returnFile:!1,pdfSettings:s},e.next=5,(0,Fe._7)(i);case 5:l=e.sent,o=new Blob([new Uint8Array(Object.values(l)).buffer],{type:"application/pdf"}),f(o),S(!0),v(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",loading:c,icon:(0,I.jsx)(hn.Z,{}),onClick:C,className:xn().actionButton,disabled:"Active"!==(null===t||void 0===t?void 0:t.pawnTicketStatus),children:"Print Ticket"}),(0,I.jsx)(un.Z,{buttonTitle:"Print Ticket",modalTitle:"Print Ticket Preview",file:x,onOpen:C,onClose:()=>S(!1),showModal:y,showTrigger:!1})]})},gn=Zn,jn=(e,n)=>Number("".concat(Math.round(parseFloat("".concat(e,"e").concat(n))),"e-").concat(n)),fn=(e,n)=>jn(e-n,2),bn=(e,n,t)=>jn(e+n+t,2),wn=(e,n)=>jn(e+n,2),kn=(e,n)=>jn(n/e*100,2),yn=(e,n)=>jn(n/100*e,2),In=(e,n)=>jn(e+n,2),Sn=t(18910),Cn=t.n(Sn),Tn=m.Z.Text,Pn=m.Z.Title,Dn=e=>{var n,t=e.ticket,i=e.customer,a=e.callback,r=de.Z.useForm(),s=(0,p.Z)(r,1),u=s[0],m=(0,g.I0)(),x=(0,g.v9)((e=>e.transaction.cartItems)),j=(0,Z.useState)(!1),f=(0,p.Z)(j,2),w=f[0],k=f[1],y=(0,Z.useState)(!1),S=(0,p.Z)(y,2),C=S[0],T=S[1],P=(0,Z.useState)(0),R=(0,p.Z)(P,2),A=R[0],V=R[1];(0,Z.useEffect)((()=>{null!=(null===t||void 0===t?void 0:t.principalValue)&&null!=(null===t||void 0===t?void 0:t.interestValue)&&V(In(t.principalValue,t.interestValue))}),[t]);var Y=function(){var e=(0,N.Z)(F().mark((function e(n){var i,a,l,r,o,s,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(T(!0),null!=n||null==(null===t||void 0===t?void 0:t.principalValue)||null==(null===t||void 0===t?void 0:t.interestValue)){e.next=6;break}i=In(t.principalValue,t.interestValue),V(i),e.next=18;break;case 6:if(l=yn(null!==(a=null===t||void 0===t?void 0:t.interestValue)&&void 0!==a?a:0,n),r=u.getFieldsValue(),u.setFieldsValue((0,v.Z)((0,v.Z)({},r),{},{discountAmt:l})),e.t0=null!=(null===t||void 0===t?void 0:t._id),!e.t0){e.next=14;break}return e.next=13,(0,Fe._9)({pawnTicketId:t._id,discount:l});case 13:e.t0=e.sent;case 14:o=e.t0,s=(null===o||void 0===o?void 0:o.interestValueAfterDiscount)||0,d=null!=(null===t||void 0===t?void 0:t.principalValue)?In(t.principalValue,s):0,V(d);case 18:T(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),B=function(){var e=(0,N.Z)(F().mark((function e(n){var i,a,l,r,o,s,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(T(!0),null!=n||null==(null===t||void 0===t?void 0:t.principalValue)||null==(null===t||void 0===t?void 0:t.interestValue)){e.next=6;break}i=In(t.principalValue,t.interestValue),V(i),e.next=18;break;case 6:if(l=kn(null!==(a=null===t||void 0===t?void 0:t.interestValue)&&void 0!==a?a:0,n),r=u.getFieldsValue(),u.setFieldsValue((0,v.Z)((0,v.Z)({},r),{},{discountRate:l})),e.t0=null!=(null===t||void 0===t?void 0:t._id),!e.t0){e.next=14;break}return e.next=13,(0,Fe._9)({pawnTicketId:t._id,discount:n});case 13:e.t0=e.sent;case 14:o=e.t0,s=(null===o||void 0===o?void 0:o.interestValueAfterDiscount)||0,d=null!=(null===t||void 0===t?void 0:t.principalValue)?In(t.principalValue,s):0,V(d);case 18:T(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=()=>{k(!0)},E=()=>{k(!1)},z=function(){var e=(0,N.Z)(F().mark((function e(n){var l;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l={actionType:ee.REDEEM,customer:i,ticket:t,transactionDetails:{pawnTicketId:null===t||void 0===t?void 0:t._id,interest:null===t||void 0===t?void 0:t.interestValue,discount:n.discountAmt,netValue:A,totalToPay:A}},!x.find((e=>{var n;return(null===e||void 0===e||null===(n=e.transactionDetails)||void 0===n?void 0:n.pawnTicketId)===l.transactionDetails.pawnTicketId}))){e.next=5;break}M.ZP.error("Ticket already in cart"),e.next=12;break;case 5:return x.push(l),e.next=8,le().setItem(ne.qW,x);case 8:m({type:"transaction/setCartItems",payload:x}),E(),M.ZP.success("Added to Cart"),a();case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(Xe.Z,{}),className:Cn().actionButton,onClick:_,disabled:"Renewed"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Revalued"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Redeemed"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Void"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Sold"===(null===t||void 0===t?void 0:t.pawnTicketStatus),children:"Redeem"}),(0,I.jsxs)(h.Z,{title:"Redeem (Pawn No: ".concat(null===t||void 0===t?void 0:t.pawnNo,")"),visible:w,width:600,footer:null,onCancel:E,centered:!0,destroyOnClose:!0,children:[null==t?null:(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===t||void 0===t?void 0:t.dueDate)?"-":me()(t.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Principle (RM)",children:null==(null===t||void 0===t?void 0:t.principalValue)?"-":t.principalValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===t||void 0===t?void 0:t.createdAt)?"-":me()(t.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===t||void 0===t?void 0:t.createdAt)?"-":me()(t.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(Tn,{type:null!=(null===t||void 0===t?void 0:t.interestMonthCount)&&(null===t||void 0===t?void 0:t.interestMonthCount)>6?"danger":void 0,children:null!=(null===t||void 0===t?void 0:t.interestMonthCount)?t.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===t||void 0===t||null===(n=t.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(t.pawnTicketsSubId.totalWeight,"g")}),(0,I.jsx)(o.Z.Item,{label:"Interest (RM)",children:null==(null===t||void 0===t?void 0:t.interestValue)?"-":null===t||void 0===t?void 0:t.interestValue.toFixed(2)})]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(de.Z,{form:u,name:"basic",labelCol:{span:10},wrapperCol:{span:24},initialValues:{discountRate:0,discountAmt:0},onFinish:z,autoComplete:"off",children:[(0,I.jsx)(de.Z.Item,{label:"Interest Discount Rate:",name:"discountRate",children:(0,I.jsx)(Je.Z,{min:0,max:100,addonAfter:"%",onChange:Y})}),(0,I.jsx)(de.Z.Item,{label:"Interest Discount Amount:",name:"discountAmt",children:(0,I.jsx)(Je.Z,{min:0,controls:!1,addonBefore:"RM",onChange:B})}),(0,I.jsx)(de.Z.Item,{label:"Net Total:",children:C?(0,I.jsx)(l.Z,{}):(0,I.jsxs)(Pn,{level:4,type:"success",style:{marginBottom:0},children:["RM ",A.toFixed(2)]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:E,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:Cn().submit,type:"primary",htmlType:"submit",children:"Add to Cart"})})]})]})]})]})},Mn=Dn,Nn=t(11493),Rn=t.n(Nn),Fn=m.Z.Title,An=m.Z.Text,Vn=e=>{var n,t,i=e.ticket,a=e.customer,r=e.callback,s=de.Z.useForm(),u=(0,p.Z)(s,1),m=u[0],x=(0,g.I0)(),f=(0,g.v9)((e=>e.transaction.cartItems)),w=(0,g.v9)((e=>e.config)),k=w.config,y=(0,Z.useState)(!1),S=(0,p.Z)(y,2),C=S[0],T=S[1],P=(0,Z.useState)(!1),R=(0,p.Z)(P,2),A=R[0],V=R[1],Y=(0,Z.useState)(0),B=(0,p.Z)(Y,2),_=B[0],E=B[1];(0,Z.useEffect)((()=>{var e;null!=(null===i||void 0===i?void 0:i.interestValue)&&E(wn(i.interestValue,null!==(e=null===k||void 0===k?void 0:k.handlingFee)&&void 0!==e?e:.5))}),[null===k||void 0===k?void 0:k.handlingFee,i]);var z=function(){var e=(0,N.Z)(F().mark((function e(n){var t,a,l,r,o,s;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=null==(null===i||void 0===i?void 0:i.interestValue)?0:yn(i.interestValue,n),l=m.getFieldsValue(),m.setFieldsValue((0,v.Z)((0,v.Z)({},l),{},{discountAmt:a})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=8;break}return e.next=7,(0,Fe._9)({pawnTicketId:i._id,discount:a});case 7:e.t0=e.sent;case 8:r=e.t0,o=(null===r||void 0===r?void 0:r.interestValueAfterDiscount)||0,s=jn(o+(null!==(t=null===k||void 0===k?void 0:k.handlingFee)&&void 0!==t?t:.5),2),E(s);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),W=function(){var e=(0,N.Z)(F().mark((function e(n){var t,a,l,r,o,s;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(V(!0),a=null==(null===i||void 0===i?void 0:i.interestValue)?0:kn(i.interestValue,n),l=m.getFieldsValue(),m.setFieldsValue((0,v.Z)((0,v.Z)({},l),{},{discountRate:a})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=9;break}return e.next=8,(0,Fe._9)({pawnTicketId:i._id,discount:n});case 8:e.t0=e.sent;case 9:r=e.t0,o=(null===r||void 0===r?void 0:r.interestValueAfterDiscount)||0,s=jn(o+(null!==(t=null===k||void 0===k?void 0:k.handlingFee)&&void 0!==t?t:.5),2),E(s),V(!1);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),L=()=>{T(!0)},O=()=>{T(!1),E(0)},q=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={actionType:ee.RENEW,customer:a,ticket:i,transactionDetails:{pawnTicketId:null===i||void 0===i?void 0:i._id,discount:n.discountAmt,netValue:_,totalToPay:_}},!f.find((e=>{var n;return(null===e||void 0===e||null===(n=e.transactionDetails)||void 0===n?void 0:n.pawnTicketId)===t.transactionDetails.pawnTicketId}))){e.next=5;break}M.ZP.error("Ticket already in cart"),e.next=12;break;case 5:return f.push(t),e.next=8,le().setItem(ne.qW,f);case 8:x({type:"transaction/setCartItems",payload:f}),O(),M.ZP.success("Added to Cart"),r();case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,j.Dp)((()=>{x({type:"config/getConfig"})})),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(Xe.Z,{}),className:Rn().actionButton,onClick:L,disabled:"Renewed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Revalued"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Redeemed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Void"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Sold"===(null===i||void 0===i?void 0:i.pawnTicketStatus),children:"Renew"}),(0,I.jsxs)(h.Z,{title:"Renew (Pawn No: ".concat(null===i||void 0===i?void 0:i.pawnNo,")"),visible:C,width:600,footer:null,onCancel:O,centered:!0,destroyOnClose:!0,children:[null!=i&&(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===i||void 0===i?void 0:i.dueDate)?"-":me()(i.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Principle",children:null==(null===i||void 0===i?void 0:i.principalValue)?"-":"RM ".concat(i.principalValue.toFixed(2))}),(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":me()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":me()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(An,{type:null!=(null===i||void 0===i?void 0:i.interestMonthCount)&&(null===i||void 0===i?void 0:i.interestMonthCount)>6?"danger":void 0,children:null!=(null===i||void 0===i?void 0:i.interestMonthCount)?i.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===i||void 0===i||null===(n=i.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(i.pawnTicketsSubId.totalWeight,"g")}),(0,I.jsx)(o.Z.Item,{label:"Interest Amount",children:null==(null===i||void 0===i?void 0:i.interestValue)?"-":"RM ".concat(null===i||void 0===i?void 0:i.interestValue.toFixed(2))})]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(de.Z,{form:m,labelCol:{span:10},wrapperCol:{span:24},initialValues:{discountRate:0,discountAmt:0},onFinish:q,autoComplete:"off",children:[(0,I.jsx)(de.Z.Item,{label:"Interest Discount Rate:",name:"discountRate",children:(0,I.jsx)(Je.Z,{min:0,max:100,addonAfter:"%",onChange:z})}),(0,I.jsx)(de.Z.Item,{label:"Interest Discount Amount:",name:"discountAmt",children:(0,I.jsx)(Je.Z,{min:0,controls:!1,addonBefore:"RM",onChange:W})}),(0,I.jsx)(de.Z.Item,{label:"Balance (+ Handling Fee: RM ".concat(null===k||void 0===k||null===(t=k.handlingFee)||void 0===t?void 0:t.toFixed(2),"): "),children:A?(0,I.jsx)(l.Z,{}):(0,I.jsxs)(Fn,{level:4,style:{marginBottom:0,marginLeft:4},children:["RM ",_.toFixed(2)]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:O,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:Rn().submit,type:"primary",htmlType:"submit",children:"Add to Cart"})})]})]})]})]})},Yn=Vn,Bn=t(42921),_n=t.n(Bn),En=m.Z.Text,zn=m.Z.Title,Wn=ce.Z.Option,Ln=e=>{var n,t,i=e.ticket,a=e.customer,r=e.callback,s=(0,g.I0)(),u=de.Z.useForm(),m=(0,p.Z)(u,1),x=m[0],f=(0,g.v9)((e=>e.counter)),w=f.counter,k=(0,g.v9)((e=>e.interestPackage)),y=k.interestPackages,S=(0,g.v9)((e=>e.transaction.cartItems)),C=(0,g.v9)((e=>e.config)),T=C.config,P=(0,Z.useState)(!1),R=(0,p.Z)(P,2),A=R[0],V=R[1],Y=(0,Z.useState)(!1),B=(0,p.Z)(Y,2),_=B[0],E=B[1],z=(0,Z.useState)(0),W=(0,p.Z)(z,2),L=W[0],O=W[1],q=(0,Z.useState)(0),G=(0,p.Z)(q,2),K=G[0],U=G[1],H=e=>{if(null==e)O(0),U(0);else{var n,t,a,l=fn(null!==(n=null===i||void 0===i?void 0:i.principalValue)&&void 0!==n?n:0,e);O(l);var r=bn(l,null!==(t=null===i||void 0===i?void 0:i.interestValue)&&void 0!==t?t:0,null!==(a=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==a?a:0);U(r)}},J=function(){var e=(0,N.Z)(F().mark((function e(n){var t,a,l,r,o,s,u,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(E(!0),null!=n||null==(null===i||void 0===i?void 0:i.principalValue)||null==(null===i||void 0===i?void 0:i.interestValue)){e.next=6;break}a=bn(L,i.interestValue,null!==(t=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==t?t:.5),U(a),e.next=18;break;case 6:if(r=yn((null===i||void 0===i?void 0:i.interestValue)||0,n),o=x.getFieldsValue(),x.setFieldsValue((0,v.Z)((0,v.Z)({},o),{},{discountAmt:r})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=14;break}return e.next=13,(0,Fe._9)({pawnTicketId:i._id,discount:r});case 13:e.t0=e.sent;case 14:s=e.t0,u=(null===s||void 0===s?void 0:s.interestValueAfterDiscount)||0,d=bn(L,u,null!==(l=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==l?l:.5),U(d);case 18:E(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),X=function(){var e=(0,N.Z)(F().mark((function e(n){var t,a,l,r,o,s,u,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(E(!0),null!=n||null==(null===i||void 0===i?void 0:i.principalValue)||null==(null===i||void 0===i?void 0:i.interestValue)){e.next=6;break}a=bn(L,i.interestValue,null!==(t=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==t?t:.5),U(a),e.next=18;break;case 6:if(r=kn((null===i||void 0===i?void 0:i.interestValue)||0,n),o=x.getFieldsValue(),x.setFieldsValue((0,v.Z)((0,v.Z)({},o),{},{discountRate:r})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=14;break}return e.next=13,(0,Fe._9)({pawnTicketId:i._id,discount:n});case 13:e.t0=e.sent;case 14:s=e.t0,u=(null===s||void 0===s?void 0:s.interestValueAfterDiscount)||0,d=bn(L,u,null!==(l=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==l?l:0),U(d);case 18:E(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),$=()=>{V(!0)},te=()=>{V(!1),U(0),O(0)},ie=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={actionType:ee.REVALUE,customer:a,ticket:i,transactionDetails:{pawnTicketId:null===i||void 0===i?void 0:i._id,principalValue:n.newPrinciple,discount:n.discountAmt,interestPackageId:n.interestPackageId,totalToPay:K}},!S.find((e=>{var n;return(null===e||void 0===e||null===(n=e.transactionDetails)||void 0===n?void 0:n.pawnTicketId)===t.transactionDetails.pawnTicketId}))){e.next=5;break}M.ZP.error("Ticket already in cart"),e.next=12;break;case 5:return S.push(t),e.next=8,le().setItem(ne.qW,S);case 8:s({type:"transaction/setCartItems",payload:S}),te(),M.ZP.success("Added to Cart"),r();case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,j.Dp)((()=>{var e;s({type:"interestPackage/getInterestPackages",shopId:null===w||void 0===w||null===(e=w.shopId)||void 0===e?void 0:e._id}),s({type:"config/getConfig"})})),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(Xe.Z,{}),className:_n().actionButton,onClick:$,disabled:"Renewed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Revalued"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Redeemed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Void"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Sold"===(null===i||void 0===i?void 0:i.pawnTicketStatus),children:"Revalue"}),(0,I.jsxs)(h.Z,{title:"Revalue (Pawn No: ".concat(null===i||void 0===i?void 0:i.pawnNo,")"),visible:A,width:600,footer:null,onCancel:te,centered:!0,destroyOnClose:!0,children:[null!=i&&(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":me()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===i||void 0===i||null===(n=i.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(i.pawnTicketsSubId.totalWeight,"g")}),(0,I.jsx)(o.Z.Item,{label:"Principle",children:null==(null===i||void 0===i?void 0:i.principalValue)?"-":"RM ".concat(i.principalValue)}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(En,{type:null!=(null===i||void 0===i?void 0:i.interestMonthCount)&&(null===i||void 0===i?void 0:i.interestMonthCount)>6?"danger":void 0,children:null!=(null===i||void 0===i?void 0:i.interestMonthCount)?i.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===i||void 0===i?void 0:i.dueDate)?"-":me()(i.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":me()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Current Interest",children:null==(null===i||void 0===i?void 0:i.interestValue)?"-":"RM ".concat(null===i||void 0===i?void 0:i.interestValue.toFixed(2))}),(0,I.jsx)(o.Z.Item,{label:"Current Principle",children:null==(null===i||void 0===i?void 0:i.principalValue)?"-":"RM ".concat(i.principalValue.toFixed(2))})]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(de.Z,{form:x,labelCol:{span:10},wrapperCol:{span:24},initialValues:{discountRate:0,discountAmt:0,interestPackageId:null===i||void 0===i?void 0:i.interestPackageId},onFinish:ie,autoComplete:"off",children:[(0,I.jsx)(de.Z.Item,{label:"New Principle Amount:",name:"newPrinciple",rules:[{required:!0,message:"Please enter the new principle amount!"}],children:(0,I.jsx)(Je.Z,{min:0,controls:!1,addonBefore:"RM",onChange:H})}),(0,I.jsx)(de.Z.Item,{label:"Revalue Amount:",tooltip:"[New Principle Amount \u2013 Old Principle Amount]\n            If is negative means client is paying back more, \n            if is positive means client is borrowing more.",children:(0,I.jsx)(En,{children:L<0?"- RM ".concat(Math.abs(L).toFixed(2)):"RM ".concat(L.toFixed(2))})}),(0,I.jsx)(de.Z.Item,{label:"New Interest Package:",name:"interestPackageId",rules:[{required:!0,message:"Please enter interest package!"}],children:(0,I.jsx)(ce.Z,{style:{width:216},children:null!=y&&(null===y||void 0===y?void 0:y.length)>0&&y.map((e=>{var n;return(0,I.jsx)(Wn,{value:e._id,children:null!==(n=e.interestDescription)&&void 0!==n?n:"-"},(0,Q.x0)())}))})}),(0,I.jsx)(de.Z.Item,{label:"Interest Discount Rate:",name:"discountRate",children:(0,I.jsx)(Je.Z,{min:0,max:100,addonAfter:"%",onChange:J})}),(0,I.jsx)(de.Z.Item,{label:"Interest Discount Amount:",name:"discountAmt",children:(0,I.jsx)(Je.Z,{min:0,controls:!1,addonBefore:"RM",onChange:X})}),(0,I.jsx)(de.Z.Item,{label:"Balance (+ Handling Fee: RM ".concat(null===T||void 0===T||null===(t=T.handlingFee)||void 0===t?void 0:t.toFixed(2),"): "),children:_?(0,I.jsx)(l.Z,{}):(0,I.jsxs)(zn,{level:4,type:K<0?"warning":"success",style:{marginBottom:0,marginLeft:4},children:["RM ",K.toFixed(2)]})}),(0,I.jsx)(D.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:te,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:_n().submit,type:"primary",htmlType:"submit",disabled:0===K,children:"Add to Cart"})})]})]})]})]})},On=Ln,qn=e=>{var n=e.ticket,t=e.customer,i=e.callback;return(0,I.jsx)("div",{style:{marginBottom:8},children:(0,I.jsxs)(r.Z,{align:"start",size:"small",wrap:!0,children:[(0,I.jsx)(Mn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(Yn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(On,{customer:t,ticket:n,callback:i}),(0,I.jsx)(rn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(pn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(gn,{ticket:n})]})})},Gn=qn,Kn=t(66502),Un=t(99562),Hn=t(60281),Jn=(m.Z.Title,m.Z.Text),Qn=e=>{var n,t,l,r,u,v,m,x=e.ticket,g=e.customer,j=e.openTicketModal,f=x.pawnTicketsSubId,b=f.pawnItems,w=(f.pawnTickets,f.imageFiles),k=(0,Z.useState)(j),y=(0,p.Z)(k,2),S=y[0],C=y[1],T=(0,Z.useState)(!1),P=(0,p.Z)(T,2),M=P[0],N=(P[1],()=>{C(!0)}),R=()=>{C(!1)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(i.ZP.Item,{style:{padding:0},children:null!=x&&(0,I.jsx)(Hn.Z,{ticket:x,onClick:N})}),(0,I.jsxs)(h.Z,{title:"Ticket Details",visible:S,width:800,confirmLoading:M,onCancel:R,footer:null,centered:!0,destroyOnClose:!0,children:[null!=x&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Gn,{customer:g,ticket:x,callback:R}),(0,I.jsx)("div",{style:{marginTop:24,marginBottom:24},children:(0,I.jsxs)(d.Z,{gutter:16,children:[(0,I.jsx)(c.Z,{span:8,children:null!=w&&w.length>0?(0,I.jsx)(He.Z,{autoplay:!0,children:null!=w&&w.length>0&&w.map((e=>(0,I.jsx)(ue.Z,{width:200,height:200,src:e.publicUrl},(0,Q.x0)())))}):(0,I.jsx)(s.C,{shape:"square",size:150,icon:(0,I.jsx)(Un.Z,{})})}),(0,I.jsxs)(c.Z,{span:16,children:[(0,I.jsxs)(o.Z,{column:2,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Status",span:2,children:(0,I.jsx)(Ue.Z,{color:(0,Kn.r)(null!==(n=null===x||void 0===x?void 0:x.pawnTicketStatus)&&void 0!==n?n:""),children:null===x||void 0===x?void 0:x.pawnTicketStatus})}),(0,I.jsx)(o.Z.Item,{label:"Pawn No",children:(0,I.jsx)(Jn,{type:null!=(null===x||void 0===x?void 0:x.interestMonthCount)&&(null===x||void 0===x?void 0:x.interestMonthCount)>6?"danger":void 0,children:null!==(t=null===x||void 0===x?void 0:x.pawnNo)&&void 0!==t?t:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Pawn Date",children:null!==x&&void 0!==x&&x.createdAt?me()(x.createdAt).format("DD/MM/YYYY"):"-"}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(Jn,{type:null!=(null===x||void 0===x?void 0:x.interestMonthCount)&&(null===x||void 0===x?void 0:x.interestMonthCount)>6?"danger":void 0,children:null!=(null===x||void 0===x?void 0:x.interestMonthCount)?x.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Interest (RM)",children:null==(null===x||void 0===x?void 0:x.interestValue)?"-":null===x||void 0===x?void 0:x.interestValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Principle (RM)",children:null==(null===x||void 0===x?void 0:x.principalValue)?"-":null===x||void 0===x?void 0:x.principalValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Due Date",children:null!==x&&void 0!==x&&x.dueDate?me()(x.dueDate).format("DD/MM/YYYY"):"-"}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null!==(l=x.pawnTicketsSubId)&&void 0!==l&&l.totalWeight?"".concat(x.pawnTicketsSubId.totalWeight,"g"):"-"}),(0,I.jsx)(o.Z.Item,{label:"Total Items",children:null!=(null===(r=x.pawnTicketsSubId)||void 0===r?void 0:r.pawnItems)?null===(u=x.pawnTicketsSubId)||void 0===u||null===(v=u.pawnItems)||void 0===v?void 0:v.reduce(((e,n)=>{var t;return e+(null!==(t=null===n||void 0===n?void 0:n.quantity)&&void 0!==t?t:0)}),0):"-"})]}),(0,I.jsx)(D.Z,{orientation:"left",plain:!0,orientationMargin:0,children:"Customer"}),(0,I.jsxs)(o.Z,{column:1,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"NRIC/Passport",children:null!==(m=null===g||void 0===g?void 0:g.nricPassport)&&void 0!==m?m:"-"}),(0,I.jsx)(o.Z.Item,{label:"Full Name",children:null===g||void 0===g?void 0:g.fullName})]})]})]})})]}),(0,I.jsx)(D.Z,{orientation:"left",orientationMargin:0,children:"Item Details (".concat(null===b||void 0===b?void 0:b.length,")")}),(0,I.jsx)(i.ZP,{style:{marginTop:8},dataSource:b,grid:{gutter:16,xs:1,sm:2,md:3},renderItem:e=>(0,I.jsx)(i.ZP.Item,{children:(0,I.jsxs)(a.Z,{size:"small",style:{width:180},bodyStyle:{padding:8},children:[(0,I.jsx)(Jn,{strong:!0,children:"".concat(e.jewelleryType," (").concat(null===e||void 0===e?void 0:e.quantity,")")}),(0,I.jsx)(D.Z,{style:{margin:"4px 0px"}}),(0,I.jsxs)(o.Z,{column:1,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Condition",children:e.pawnCondition||"-"}),(0,I.jsx)(o.Z.Item,{label:"Gold Type",children:e.goldType||"-"})]})]})})}),(0,I.jsx)(D.Z,{plain:!0,style:{margin:"8px 0"}}),(0,I.jsx)("h3",{children:"Ticket Log"}),(0,I.jsx)("div",{id:"scrollableDiv",style:{overflow:"auto"},children:(0,I.jsx)(i.ZP,{itemLayout:"horizontal",dataSource:x.pawnTicketsSubId.pawnTickets,renderItem:e=>(0,I.jsx)(Hn.Z,{pawnTicketsSub:x.pawnTicketsSubId,ticket:e})})})]})]})};Qn.defaultProps={openTicketModal:!1};var Xn=Qn,$n=m.Z.Text,et=()=>{var e,n,t,m,b=(0,g.I0)(),w=(0,g.v9)((e=>e.loading.models.ticket)),k=(0,g.v9)((e=>e.loading.models.customer)),y=(0,g.v9)((e=>e.customer)),S=y.customer,T=(0,g.v9)((e=>e.counter)),P=T.counter,D=(0,g.v9)((e=>e.ticket)),M=D.ticket,N=D.tickets,R=(0,j.dz)(),F=R.height,A=(R.width,(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:999},sortOrder:"desc",sortField:"createdAt",search:{},filters:{shopId:null===P||void 0===P||null===(e=P.shopId)||void 0===e?void 0:e._id}}}),[null===P||void 0===P||null===(e=P.shopId)||void 0===e?void 0:e._id])),V=e=>{h.Z.error({title:"This is a black-listed customer",content:"Reason: ".concat(null!==e&&void 0!==e?e:"-")})};function Y(e){switch(e){case"Active":return"success";case"Non-Active":return"warning";case"Blacklisted":return"danger";default:return"secondary"}}var B=e=>{b({type:"ticket/getTickets",params:e})},_=(0,Z.useState)({fetchTickets:B}),E=(0,p.Z)(_,1),z=E[0];return(0,j.Dp)((()=>{b({type:"setting/getSettings"}),b({type:"config/getConfig"})})),(0,Z.useEffect)((()=>{var e=!1;return null!==S&&void 0!==S&&S._id&&!e&&(z.fetchTickets((0,v.Z)((0,v.Z)({},A),{},{searchPawnTicketByCustomer:S._id})),"Blacklisted"===(null===S||void 0===S?void 0:S.accountStatus)&&V(null===S||void 0===S?void 0:S.blacklistedReason)),()=>{e=!0}}),[z,S,A]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(d.Z,{gutter:16,children:[(0,I.jsx)(c.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(Re,{})}),(0,I.jsx)(c.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(C,{})}),(0,I.jsx)(c.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(Ke,{})})]}),(0,I.jsx)(a.Z,{title:"Customer Info",size:"small",bordered:!1,bodyStyle:{padding:"8px 0"},children:(0,I.jsx)(l.Z,{tip:"Loading...",spinning:null!==k&&void 0!==k&&k,children:null==S||null==S._id?(0,I.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE}):(0,I.jsxs)(r.Z,{size:"small",align:"start",children:[(0,I.jsx)(s.C,{shape:"square",size:80,icon:(0,I.jsx)(x.Z,{}),src:null===S||void 0===S||null===(n=S.imageFile)||void 0===n?void 0:n.publicUrl}),(0,I.jsxs)(o.Z,{column:2,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Status",children:(0,I.jsx)($n,{type:Y(null!==(t=S.accountStatus)&&void 0!==t?t:""),children:S.accountStatus})}),null!==(m="Blacklisted"===(null===S||void 0===S?void 0:S.accountStatus))&&void 0!==m?m:(0,I.jsx)(o.Z.Item,{label:"Blacklisted Reason",children:null===S||void 0===S?void 0:S.blacklistedReason}),(0,I.jsx)(o.Z.Item,{label:"NRIC/Passport",children:S.nricPassport}),(0,I.jsx)(o.Z.Item,{label:"NRIC/Passport 2",children:S.nricPassport2}),(0,I.jsx)(o.Z.Item,{label:"Full Name",children:S.fullName}),(0,I.jsx)(o.Z.Item,{label:"Phone",children:S.phoneNumber}),(0,I.jsx)(o.Z.Item,{label:"Gender",children:S.gender}),(0,I.jsx)(o.Z.Item,{label:"Race",children:S.race})]})]})})}),(0,I.jsx)(a.Z,{title:"Ticket List",size:"small",bordered:!1,headStyle:{padding:0},bodyStyle:{padding:"8px 0 0",height:F-400,overflow:"auto"},children:w?(0,I.jsx)(f.Z,{children:(0,I.jsx)(l.Z,{tip:"Loading...",style:{padding:64}})}):(0,I.jsx)("div",{id:"scrollableDiv",children:null==S||null==S._id||null==N?(0,I.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE}):(0,I.jsx)(i.ZP,{split:!1,size:"small",itemLayout:"horizontal",dataSource:N,renderItem:e=>(0,I.jsx)(Xn,{customer:S,ticket:e,openTicketModal:(null===M||void 0===M?void 0:M._id)===e._id})})})})]})},nt=et}}]);