(self["webpackChunk"]=self["webpackChunk"]||[]).push([[912],{67576:function(e){e.exports={ticketCardContainer:"ticketCardContainer___23ebF"}},52953:function(){},41009:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});n(20228);var l=n(11382),o=(n(54421),n(38272)),r=(n(13254),n(14277)),i=n(8870),c=n(2824),a=(n(402),n(70647)),s=n(67294),d=n(28168),u=n(45004),m=(n(71194),n(50146)),p=(n(48736),n(27049)),v=(n(98858),n(4914)),h=n(3182),f=n(94043),y=n.n(f),b=n(30381),Z=n.n(b),x=n(92911),g=n(49539),S=n(60281),j=(n(58024),n(91894)),E=n(67576),C=n.n(E),w=n(85893),k=e=>{var t,n,l,o,r=e.receipt,i=e.onClick;return(0,w.jsx)("div",{className:C().ticketCardContainer,style:{cursor:null==i?"default":"pointer"},children:(0,w.jsx)(j.Z,{size:"small",bordered:!1,style:{width:"100%"},bodyStyle:{paddingBottom:0},loading:!1,onClick:i,children:(0,w.jsxs)(v.Z,{column:2,children:[(0,w.jsx)(v.Z.Item,{label:"Date",children:null!==r&&void 0!==r&&r.createdAt?Z()(r.createdAt).format("DD/MM/YYYY HH:mm A"):"-"}),(0,w.jsx)(v.Z.Item,{label:"Payment Method",children:null!==(t=null===r||void 0===r?void 0:r.paymentMethod)&&void 0!==t?t:"-"}),(0,w.jsx)(v.Z.Item,{label:"Shop",children:null!==(n=null===r||void 0===r?void 0:r.shopId.name)&&void 0!==n?n:"-"}),(0,w.jsx)(v.Z.Item,{label:"Number of Ticket",children:null!==(l=null===(o=r.pawnTickets)||void 0===o?void 0:o.length)&&void 0!==l?l:"-"})]})})})};k.defaultProps={onClick:null};var I=k,N=e=>{var t=e.receipt,n=t.pawnTickets,l=(0,s.useState)(!1),r=(0,c.Z)(l,2),i=r[0],a=r[1],u=(0,s.useState)(!1),f=(0,c.Z)(u,2),b=f[0],j=(f[1],(0,s.useState)(!1)),E=(0,c.Z)(j,2),C=E[0],k=E[1],N=(0,s.useState)(),P=(0,c.Z)(N,2),M=P[0],T=P[1],R=(0,d.v9)((e=>e.counter)),_=R.counter,z=(0,d.v9)((e=>e.config)),D=z.printReceiptSetting,A=()=>{a(!0)},L=()=>{a(!1)},F=function(){var e=(0,h.Z)(y().mark((function e(){var n,l,o,r;return y().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(C||null===t||void 0===t||!t._id){e.next=9;break}return k(!0),l={shopId:null===_||void 0===_||null===(n=_.shopId)||void 0===n?void 0:n._id,receipts:[null===t||void 0===t?void 0:t._id],showMaxWidth:!1,returnFile:!1,pdfSettings:D},e.next=5,(0,x.$5)(l);case 5:o=e.sent,r=new Blob([new Uint8Array(Object.values(o)).buffer],{type:"application/pdf"}),T(r),k(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(o.ZP.Item,{children:null!=t&&(0,w.jsx)(I,{receipt:t,onClick:A})}),(0,w.jsxs)(m.Z,{title:"Receipt Details",visible:i,width:800,confirmLoading:b,onCancel:L,footer:null,bodyStyle:{paddingTop:16},centered:!0,children:[null!=t&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(g.Z,{buttonTitle:"Print Receipt",modalTitle:"Print Receipt Preview",file:M,onOpen:F,printerType:"receipt"}),(0,w.jsxs)(v.Z,{column:2,size:"small",labelStyle:{fontWeight:"bold"},style:{marginTop:8},children:[(0,w.jsx)(v.Z.Item,{label:"Date",children:null!==t&&void 0!==t&&t.createdAt?Z()(t.createdAt).format("DD/MM/YYYY HH:mm A"):"-"}),(0,w.jsx)(v.Z.Item,{label:"Employee",children:null==(null===t||void 0===t?void 0:t.userId)?"-":t.userId.nric}),(0,w.jsx)(v.Z.Item,{label:"Shop",children:null==(null===t||void 0===t?void 0:t.shopId)?"-":null===t||void 0===t?void 0:t.shopId.shopFullName}),(0,w.jsx)(v.Z.Item,{label:"Payment Method",children:null==(null===t||void 0===t?void 0:t.paymentMethod)?"-":null===t||void 0===t?void 0:t.paymentMethod}),(0,w.jsx)(v.Z.Item,{label:"Reference",children:null==(null===t||void 0===t?void 0:t.reference)?"-":null===t||void 0===t?void 0:t.reference})]})]}),(0,w.jsx)(p.Z,{plain:!0,style:{margin:"8px 0"}}),(0,w.jsx)("h3",{children:"Tickets"}),(0,w.jsx)("div",{id:"scrollableDiv",style:{overflow:"auto"},children:(0,w.jsx)(o.ZP,{itemLayout:"horizontal",dataSource:n,renderItem:e=>(0,w.jsx)(S.Z,{ticket:e})})})]})]})},P=N,M=a.Z.Title,T=()=>{var e,t=(0,d.I0)(),n=(0,d.v9)((e=>e.counter)),a=n.counter,m=(0,d.v9)((e=>e.loading.models.ticket)),p=(0,d.v9)((e=>e.ticket)),v=p.receipts,h=p.receiptTotal,f=(0,u.dz)(),y=f.height,b=(f.width,e=>{t({type:"ticket/getReceipts",params:e})}),Z=e=>{t({type:"config/getPrintReceiptSetting",shopId:e})},x=(0,s.useState)({fetchReceipts:b,fetchPrintReceiptSetting:Z}),g=(0,c.Z)(x,1),S=g[0],j=(0,s.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:10},sortOrder:"desc",sortField:"createdAt",search:{},filters:{shopId:null===a||void 0===a||null===(e=a.shopId)||void 0===e?void 0:e._id}}}),[null===a||void 0===a||null===(e=a.shopId)||void 0===e?void 0:e._id]),E=(0,s.useState)(j.pagination),C=(0,c.Z)(E,2),k=C[0],I=C[1],N=e=>{b((0,i.Z)((0,i.Z)({},j),{},{pagination:(0,i.Z)((0,i.Z)({},k),{},{current:null!==e&&void 0!==e?e:1})})),I((0,i.Z)((0,i.Z)({},k),{},{current:null!==e&&void 0!==e?e:1}))},T={total:h,showSizeChanger:!0,onChange:e=>{N(e)},showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items"),current:k.current,pageSize:k.pageSize};return(0,s.useEffect)((()=>{var e,t;null!==a&&void 0!==a&&null!==(e=a.shopId)&&void 0!==e&&e._id&&(S.fetchReceipts(j),S.fetchPrintReceiptSetting(null===a||void 0===a||null===(t=a.shopId)||void 0===t?void 0:t._id))}),[S,j,a]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(M,{level:4,style:{marginLeft:16},children:"Receipt"}),(0,w.jsx)(l.Z,{tip:"Loading...",spinning:null!==m&&void 0!==m&&m,children:(0,w.jsx)("div",{id:"scrollableDiv",style:{height:y-180,overflow:"auto"},children:null==v?(0,w.jsx)(r.Z,{image:r.Z.PRESENTED_IMAGE_SIMPLE}):(0,w.jsx)(o.ZP,{split:!1,size:"small",itemLayout:"horizontal",pagination:T,dataSource:v,renderItem:e=>(0,w.jsx)(P,{receipt:e})})})})]})},R=T},4914:function(e,t,n){"use strict";n.d(t,{K:function(){return S},Z:function(){return I}});var l=n(96156),o=n(28481),r=n(90484),i=n(67294),c=n(94184),a=n.n(c),s=n(50344),d=n(24308),u=n(65632),m=n(22122);function p(e){return void 0!==e&&null!==e}var v=function(e){var t,n=e.itemPrefixCls,o=e.component,r=e.span,c=e.className,s=e.style,d=e.labelStyle,u=e.contentStyle,m=e.bordered,v=e.label,h=e.content,f=e.colon,y=o;return m?i.createElement(y,{className:a()((t={},(0,l.Z)(t,"".concat(n,"-item-label"),p(v)),(0,l.Z)(t,"".concat(n,"-item-content"),p(h)),t),c),style:s,colSpan:r},p(v)&&i.createElement("span",{style:d},v),p(h)&&i.createElement("span",{style:u},h)):i.createElement(y,{className:a()("".concat(n,"-item"),c),style:s,colSpan:r},i.createElement("div",{className:"".concat(n,"-item-container")},(v||0===v)&&i.createElement("span",{className:a()("".concat(n,"-item-label"),(0,l.Z)({},"".concat(n,"-item-no-colon"),!f)),style:d},v),(h||0===h)&&i.createElement("span",{className:a()("".concat(n,"-item-content")),style:u},h)))},h=v;function f(e,t,n){var l=t.colon,o=t.prefixCls,r=t.bordered,c=n.component,a=n.type,s=n.showLabel,d=n.showContent,u=n.labelStyle,p=n.contentStyle;return e.map((function(e,t){var n=e.props,v=n.label,f=n.children,y=n.prefixCls,b=void 0===y?o:y,Z=n.className,x=n.style,g=n.labelStyle,S=n.contentStyle,j=n.span,E=void 0===j?1:j,C=e.key;return"string"===typeof c?i.createElement(h,{key:"".concat(a,"-").concat(C||t),className:Z,style:x,labelStyle:(0,m.Z)((0,m.Z)({},u),g),contentStyle:(0,m.Z)((0,m.Z)({},p),S),span:E,colon:l,component:c,itemPrefixCls:b,bordered:r,label:s?v:null,content:d?f:null}):[i.createElement(h,{key:"label-".concat(C||t),className:Z,style:(0,m.Z)((0,m.Z)((0,m.Z)({},u),x),g),span:1,colon:l,component:c[0],itemPrefixCls:b,bordered:r,label:v}),i.createElement(h,{key:"content-".concat(C||t),className:Z,style:(0,m.Z)((0,m.Z)((0,m.Z)({},p),x),S),span:2*E-1,component:c[1],itemPrefixCls:b,bordered:r,content:f})]}))}var y=function(e){var t=i.useContext(S),n=e.prefixCls,l=e.vertical,o=e.row,r=e.index,c=e.bordered;return l?i.createElement(i.Fragment,null,i.createElement("tr",{key:"label-".concat(r),className:"".concat(n,"-row")},f(o,e,(0,m.Z)({component:"th",type:"label",showLabel:!0},t))),i.createElement("tr",{key:"content-".concat(r),className:"".concat(n,"-row")},f(o,e,(0,m.Z)({component:"td",type:"content",showContent:!0},t)))):i.createElement("tr",{key:r,className:"".concat(n,"-row")},f(o,e,(0,m.Z)({component:c?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},t)))},b=y,Z=function(e){var t=e.children;return t},x=Z,g=n(96159),S=i.createContext({}),j={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function E(e,t){if("number"===typeof e)return e;if("object"===(0,r.Z)(e))for(var n=0;n<d.c4.length;n++){var l=d.c4[n];if(t[l]&&void 0!==e[l])return e[l]||j[l]}return 3}function C(e,t,n){var l=e;return(void 0===t||t>n)&&(l=(0,g.Tm)(e,{span:n})),l}function w(e,t){var n=(0,s.Z)(e).filter((function(e){return e})),l=[],o=[],r=t;return n.forEach((function(e,i){var c,a=null===(c=e.props)||void 0===c?void 0:c.span,s=a||1;if(i===n.length-1)return o.push(C(e,a,r)),void l.push(o);s<r?(r-=s,o.push(e)):(o.push(C(e,s,r)),l.push(o),r=t,o=[])})),l}function k(e){var t,n=e.prefixCls,c=e.title,s=e.extra,m=e.column,p=void 0===m?j:m,v=e.colon,h=void 0===v||v,f=e.bordered,y=e.layout,Z=e.children,x=e.className,g=e.style,C=e.size,k=e.labelStyle,I=e.contentStyle,N=i.useContext(u.E_),P=N.getPrefixCls,M=N.direction,T=P("descriptions",n),R=i.useState({}),_=(0,o.Z)(R,2),z=_[0],D=_[1],A=E(p,z);i.useEffect((function(){var e=d.ZP.subscribe((function(e){"object"===(0,r.Z)(p)&&D(e)}));return function(){d.ZP.unsubscribe(e)}}),[]);var L=w(Z,A),F=i.useMemo((function(){return{labelStyle:k,contentStyle:I}}),[k,I]);return i.createElement(S.Provider,{value:F},i.createElement("div",{className:a()(T,(t={},(0,l.Z)(t,"".concat(T,"-").concat(C),C&&"default"!==C),(0,l.Z)(t,"".concat(T,"-bordered"),!!f),(0,l.Z)(t,"".concat(T,"-rtl"),"rtl"===M),t),x),style:g},(c||s)&&i.createElement("div",{className:"".concat(T,"-header")},c&&i.createElement("div",{className:"".concat(T,"-title")},c),s&&i.createElement("div",{className:"".concat(T,"-extra")},s)),i.createElement("div",{className:"".concat(T,"-view")},i.createElement("table",null,i.createElement("tbody",null,L.map((function(e,t){return i.createElement(b,{key:t,index:t,colon:h,prefixCls:T,vertical:"vertical"===y,bordered:f,row:e})})))))))}k.Item=x;var I=k},98858:function(e,t,n){"use strict";n(38663),n(52953)}}]);