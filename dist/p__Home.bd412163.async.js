(self["webpackChunk"]=self["webpackChunk"]||[]).push([[371],{76063:function(e){e.exports={actionButton:"actionButton___2STiz"}},95657:function(e){e.exports={actionButton:"actionButton___15rFb"}},46888:function(e){e.exports={actionButton:"actionButton___2Bp6Y"}},18910:function(e){e.exports={actionButton:"actionButton___2XPac"}},11493:function(e){e.exports={actionButton:"actionButton___Vskk9"}},42921:function(e){e.exports={actionButton:"actionButton___2FU4C"}},33026:function(e){e.exports={bigButton:"bigButton___2qf4t"}},21746:function(e){e.exports={bigButton:"bigButton___tcIYX"}},37217:function(e){e.exports={bigButton:"bigButton___1RHS2"}},11829:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Xn}});t(54421);var i=t(38272),l=(t(58024),t(39144)),a=(t(20228),t(11382)),r=(t(49111),t(19650)),o=(t(98858),t(4914)),s=(t(94233),t(51890)),u=(t(13254),t(14277)),d=(t(13062),t(71230)),c=(t(89032),t(15746)),v=t(8870),p=t(2824),h=(t(71194),t(50146)),m=(t(402),t(70647)),x=t(89366),Z=t(67294),j=t(28168),g=t(45004),f=t(8847),b=(t(57663),t(71577)),w=t(85369),k=t(33026),y=t.n(k),I=t(85893),C=e=>{var n=(0,Z.useState)(!1),t=(0,p.Z)(n,2),i=t[0],l=t[1],a=(0,Z.useState)(!1),r=(0,p.Z)(a,2),o=r[0],s=r[1],u=(0,Z.useState)("Content of the modal"),d=(0,p.Z)(u,2),c=d[0],v=d[1],m=()=>{l(!0)},x=()=>{l(!1)},j=()=>{v("The modal will be closed after two seconds"),s(!0),setTimeout((()=>{l(!1),s(!1)}),2e3)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(w.Z,{}),className:y().bigButton,onClick:m,children:"Gold Price Calculator"}),(0,I.jsx)(h.Z,{title:"Gold Price Calculator",visible:i,onOk:j,confirmLoading:o,onCancel:x,centered:!0,destroyOnClose:!0,children:(0,I.jsx)("p",{children:c})})]})},S=C,T=(t(84305),t(75901)),D=(t(71748),t(33860)),P=(t(48736),t(27049)),M=(t(34792),t(48086)),N=t(3182),V=t(94043),F=t.n(V),R=t(73171),A=t(12044),Y=t(49101),_=t(57895),B=t(952),z=t(61036),E=t(64317),L=t(5436),O=t(97462),W=t(5966),q=t(31199),G=t(59962),U=t(24739),K=t(10927),H=t(18253),J=t(41741),Q=t(17244),X=t(46747),$=t(3682),ee={NEW:"NEW",REVALUE:"REVALUE",REDEEM:"REDEEM",RENEW:"RENEW",EXTEND:"EXTEND"},ne=(t(17673),e=>e[0].toUpperCase()+e.slice(1).toLowerCase()),te=e=>e.filter(((n,t)=>t===e.findIndex((e=>e.value===n.value)))),ie=(t(14965),t(68588)),le=(t(47673),t(4107)),ae=(t(43185),t(94412)),re=(t(12968),t(62462)),oe=(t(9715),t(17681)),se=(t(43358),t(34041)),ue=t(31223),de=t(7085),ce=t(30381),ve=t.n(ce),pe=["Malaysian","Thai","Vietnamese","Indonesian","Burmese","Sri Lankan","Bangladeshi","Cambodian","Indian","Pakistani","Filipino","Afghan","Albanian","Algerian","American","Andorran","Angolan","Antiguans","Argentinean","Armenian","Australian","Austrian","Azerbaijani","Bahamian","Bahraini","Bangladeshi","Barbadian","Barbudans","Batswana","Belarusian","Belgian","Belizean","Beninese","Bhutanese","Bolivian","Bosnian","Brazilian","British","Bruneian","Bulgarian","Burkinabe","Burmese","Burundian","Cambodian","Cameroonian","Canadian","Cape Verdean","Central African","Chadian","Chilean","Chinese","Colombian","Comoran","Congolese","Costa Rican","Croatian","Cuban","Cypriot","Czech","Danish","Djibouti","Dominican","Dutch","East Timorese","Ecuadorean","Egyptian","Emirian","Equatorial Guinean","Eritrean","Estonian","Ethiopian","Fijian","Filipino","Finnish","French","Gabonese","Gambian","Georgian","German","Ghanaian","Greek","Grenadian","Guatemalan","Guinea-Bissauan","Guinean","Guyanese","Haitian","Herzegovinian","Honduran","Hungarian","I-Kiribati","Icelander","Indian","Indonesian","Iranian","Iraqi","Irish","Israeli","Italian","Ivorian","Jamaican","Japanese","Jordanian","Kazakhstani","Kenyan","Kittian and Nevisian","Kuwaiti","Kyrgyz","Laotian","Latvian","Lebanese","Liberian","Libyan","Liechtensteiner","Lithuanian","Luxembourger","Macedonian","Malagasy","Malawian","Malaysian","Maldivan","Malian","Maltese","Marshallese","Mauritanian","Mauritian","Mexican","Micronesian","Moldovan","Monacan","Mongolian","Moroccan","Mosotho","Motswana","Mozambican","Namibian","Nauruan","Nepalese","New Zealander","Nicaraguan","Nigerian","Nigerien","North Korean","Northern Irish","Norwegian","Omani","Pakistani","Palauan","Panamanian","Papua New Guinean","Paraguayan","Peruvian","Polish","Portuguese","Qatari","Romanian","Russian","Rwandan","Saint Lucian","Salvadoran","Samoan","San Marinese","Sao Tomean","Saudi","Scottish","Senegalese","Serbian","Seychellois","Sierra Leonean","Singaporean","Slovakian","Slovenian","Solomon Islander","Somali","South African","South Korean","Spanish","Sri Lankan","Sudanese","Surinamer","Swazi","Swedish","Swiss","Syrian","Taiwanese","Tajik","Tanzanian","Thai","Togolese","Tongan","Trinidadian or Tobagonian","Tunisian","Turkish","Tuvaluan","Ugandan","Ukrainian","Uruguayan","Uzbekistani","Venezuelan","Vietnamese","Welsh","Yemenite","Zambian","Zimbabwean"];function he(e,n){return me.apply(this,arguments)}function me(){return me=(0,N.Z)(F().mark((function e(n,t){var i,l;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(n);case 2:return i=e.sent,e.next=5,i.blob();case 5:return l=e.sent,e.abrupt("return",new File([l],t,{type:"image/jpeg"}));case 7:case"end":return e.stop()}}),e)}))),me.apply(this,arguments)}t(59250);var xe=t(16114),Ze=(t(30887),t(28682)),je=t(72709),ge=function(){var e=(0,N.Z)(F().mark((function e(){var n;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,je.ns)("/reader-without-fp",{timeout:1e4});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=(0,N.Z)(F().mark((function e(){var n;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,je.tm)("/reader-with-fp",{timeout:1e4});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),be=t(81473),we=e=>{var n=e.title,t=e.buttonSize,i=e.callback,l=(0,Z.useState)(!1),a=(0,p.Z)(l,2),r=a[0],o=a[1],s=function(){var e=(0,N.Z)(F().mark((function e(){var n,t,l,a,r;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ge();case 3:n=e.sent,console.log(n),t=null!=(null===n||void 0===n?void 0:n.DOB)?ve()(null===n||void 0===n?void 0:n.DOB,"DD/MM/YYYY"):void 0,l=null!=(null===n||void 0===n?void 0:n.Photo)?"data:image/jpeg;base64, ".concat(n.Photo):void 0,a="Others","L"===(null===n||void 0===n?void 0:n.Gender)&&(a="Male"),"P"===(null===n||void 0===n?void 0:n.Gender)&&(a="Female"),r={nricPassport:null===n||void 0===n?void 0:n.ICNo,fullName:null===n||void 0===n?void 0:n.Name,gender:a,birthDate:t,race:ne(null===n||void 0===n?void 0:n.Race),address1:null===n||void 0===n?void 0:n.Addr1,address2:null===n||void 0===n?void 0:n.Addr2,address3:"".concat(null===n||void 0===n?void 0:n.Postcode," ").concat(null===n||void 0===n?void 0:n.City),address4:null===n||void 0===n?void 0:n.State,imageString:l},i(r),o(!1),e.next=20;break;case 15:e.prev=15,e.t0=e["catch"](0),console.log(e.t0),M.ZP.error("scan ic error!"),o(!1);case 20:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,N.Z)(F().mark((function e(){var n,t,l,a,r,s,u,d,c,v,p,h,m,x,Z,j,g,f,b,w,k,y,I,C,S,T,D;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fe();case 3:n=e.sent,console.log(n),null!=(null===n||void 0===n?void 0:n.Data)&&(C=null!=(null===n||void 0===n||null===(t=n.Data)||void 0===t||null===(l=t.MYKAD)||void 0===l?void 0:l.DOB)?ve()(null===n||void 0===n||null===(a=n.Data)||void 0===a||null===(r=a.MYKAD)||void 0===r?void 0:r.DOB,"DD-MM-YYYY"):void 0,S=null!=(null===n||void 0===n||null===(s=n.Data)||void 0===s||null===(u=s.MYKAD)||void 0===u?void 0:u.Photo)?"data:image/jpeg;base64, ".concat(n.Data.MYKAD.Photo):void 0,T="Others","L"===(null===n||void 0===n||null===(d=n.Data)||void 0===d||null===(c=d.MYKAD)||void 0===c?void 0:c.Gender)&&(T="Male"),"P"===(null===n||void 0===n||null===(v=n.Data)||void 0===v||null===(p=v.MYKAD)||void 0===p?void 0:p.Gender)&&(T="Female"),D={nricPassport:null===n||void 0===n||null===(h=n.Data)||void 0===h||null===(m=h.MYKAD)||void 0===m?void 0:m.ICNumber,fullName:null===n||void 0===n||null===(x=n.Data)||void 0===x||null===(Z=x.MYKAD)||void 0===Z?void 0:Z.GMPCName,gender:T,birthDate:C,race:ne(null===n||void 0===n||null===(j=n.Data)||void 0===j||null===(g=j.MYKAD)||void 0===g?void 0:g.Race),address1:null===n||void 0===n||null===(f=n.Data)||void 0===f||null===(b=f.MYKAD)||void 0===b?void 0:b.Address1,address2:null===n||void 0===n||null===(w=n.Data)||void 0===w||null===(k=w.MYKAD)||void 0===k?void 0:k.Address2,address3:null===n||void 0===n||null===(y=n.Data)||void 0===y||null===(I=y.MYKAD)||void 0===I?void 0:I.Address3,imageString:S},i(D),o(!1)),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0),M.ZP.error("scan ic error!"),o(!1);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o(!0),"fp"!==n){e.next=6;break}return e.next=4,u();case 4:e.next=8;break;case 6:return e.next=8,s();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),c=()=>{o(!1)},v=(0,I.jsx)(Ze.Z,{items:[{label:(0,I.jsx)(b.Z,{type:"text",onClick:()=>d("fp"),children:"With Fingerprint"}),key:"0"},{label:(0,I.jsx)(b.Z,{type:"text",onClick:()=>d(),children:"Without Fringerprint"}),key:"1"}]});return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(xe.Z,{overlay:v,trigger:["click"],children:(0,I.jsx)(b.Z,{icon:(0,I.jsx)(be.Z,{}),size:t,onClick:e=>e.preventDefault(),children:n})}),(0,I.jsx)(h.Z,{title:"Scanning is in progress",width:250,visible:r,footer:null,closable:!1,centered:!0,destroyOnClose:!0,children:(0,I.jsxs)(f.Z,{children:[(0,I.jsx)(be.Z,{style:{fontSize:100,marginBottom:24}}),(0,I.jsx)(b.Z,{size:"large",danger:!0,onClick:c,children:"Cancel"})]})})]})};we.defaultProps={title:void 0,buttonSize:"middle"};var ke=we,ye=se.Z.Option,Ie=e=>{var n=(0,j.I0)(),t=e.callback,i=(0,j.v9)((e=>e.counter)),l=i.counter,a=(0,Z.useState)(!1),r=(0,p.Z)(a,2),o=r[0],s=r[1],u=(0,Z.useState)(!1),m=(0,p.Z)(u,2),x=m[0],g=m[1],f=(0,Z.useState)(!1),w=(0,p.Z)(f,2),k=w[0],y=w[1],C=(0,Z.useState)(),S=(0,p.Z)(C,2),D=S[0],P=S[1],M=oe.Z.useForm(),V=(0,p.Z)(M,1),R=V[0],A=()=>{y(!0)},_=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=(null===n||void 0===n?void 0:n.nricPassport)&&""!==(null===n||void 0===n?void 0:n.nricPassport)&&R.setFieldsValue(n),null==(null===n||void 0===n?void 0:n.imageString)||""===(null===n||void 0===n?void 0:n.imageString)){e.next=6;break}return e.next=4,he(n.imageString,"profileImage");case 4:t=e.sent,P(t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),B=()=>{R.resetFields(),s(!1),g(!1),P(void 0)},z=()=>{B(),y(!1),s(!1)},E=function(){var e=(0,N.Z)(F().mark((function e(i){var a,r,o;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s(!0),e.next=3,(0,X.wK)((0,v.Z)((0,v.Z)({},i),{},{birthDate:null===(a=i.birthDate)||void 0===a?void 0:a.format("YYYY-MM-DD"),shopId:null===l||void 0===l||null===(r=l.shopId)||void 0===r?void 0:r._id}));case 3:if(o=e.sent,o.status||null==o._id){e.next=13;break}if(null==D){e.next=8;break}return e.next=8,(0,X.vu)({file:D,customerId:o._id});case 8:return e.next=10,n({type:"customer/setCustomer",payload:o});case 10:null!=t&&t(o),y(!1),B();case 13:s(!1);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();oe.Z.Item,se.Z;return(0,I.jsxs)(T.ZP,{locale:H.Z,children:[(0,I.jsx)(b.Z,{icon:(0,I.jsx)(ue.Z,{}),size:"large",onClick:A,type:"link",children:"Register New Customer"}),(0,I.jsx)(h.Z,{title:"Register New Customer",width:800,onCancel:z,confirmLoading:!0,footer:[(0,I.jsx)(ke,{callback:_,title:"Scan IC"},"scan"),(0,I.jsx)(b.Z,{onClick:z,children:"Cancel"},"back"),(0,I.jsx)(b.Z,{type:"primary",loading:o,onClick:()=>{R.validateFields().then(function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,E(n);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((e=>{console.log("Validate Failed:",e)}))},children:"Register"},"submit")],visible:k,centered:!0,destroyOnClose:!0,children:(0,I.jsx)(oe.Z,{form:R,layout:"vertical",name:"register",requiredMark:!1,initialValues:{prefix:"60",birthDate:ve()("1990-01-01","YYYY-MM-DD"),nationality:"Malaysian"},children:(0,I.jsxs)(d.Z,{gutter:32,children:[(0,I.jsxs)(c.Z,{span:12,children:[(0,I.jsxs)("div",{style:{marginBottom:8},children:[(0,I.jsx)("p",{children:"Profile Image"}),(0,I.jsx)(ae.Z,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,beforeUpload:function(){var e=(0,N.Z)(F().mark((function e(n){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return g(!0),t={maxSizeMB:.6,useWebWorker:!0,fileType:"image/jpeg"},e.next=4,(0,J.Z)(n,t);case 4:return i=e.sent,console.log("compressedFile size ".concat(i.size/1024/1024," MB")),P(i),g(!1),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:D?(0,I.jsx)(re.Z,{src:URL.createObjectURL(D),alt:"avatar",style:{width:"100%"}}):(0,I.jsxs)("div",{children:[x?(0,I.jsx)(de.Z,{}):(0,I.jsx)(Y.Z,{}),(0,I.jsx)("div",{style:{marginTop:8},children:"Upload"})]})})]}),(0,I.jsx)(oe.Z.Item,{name:"nricPassport",label:"NRIC/Passport",rules:[{required:!0,message:"Please input your NRIC/Passport!"}],children:(0,I.jsx)(le.Z,{})}),(0,I.jsx)(oe.Z.Item,{name:"nricPassport2",label:"NRIC/Passport 2",children:(0,I.jsx)(le.Z,{})}),(0,I.jsx)(oe.Z.Item,{name:"fullName",label:"Full Name",rules:[{required:!0,message:"Please input your Full Name!"}],children:(0,I.jsx)(le.Z,{})}),(0,I.jsxs)(d.Z,{gutter:8,children:[(0,I.jsx)(c.Z,{span:12,children:(0,I.jsx)(oe.Z.Item,{name:"birthDate",label:"Birth Date",rules:[{required:!0,message:"Please select your birth date!"}],children:(0,I.jsx)(ie.Z,{style:{width:"100%"},format:"YYYY-MM-DD"})})}),(0,I.jsx)(c.Z,{span:12,children:(0,I.jsx)(oe.Z.Item,{name:"gender",label:"Gender",rules:[{required:!0,message:"Please select your gender!"}],children:(0,I.jsxs)(se.Z,{placeholder:"Select your gender",children:[(0,I.jsx)(ye,{value:"Male",children:"Male"}),(0,I.jsx)(ye,{value:"Female",children:"Female"}),(0,I.jsx)(ye,{value:"Others",children:"Others"})]})})})]})]}),(0,I.jsxs)(c.Z,{span:12,children:[(0,I.jsx)(oe.Z.Item,{name:"address1",label:"Address",rules:[{required:!0,message:"Please input your address!"}],children:(0,I.jsx)(le.Z,{})}),(0,I.jsx)(oe.Z.Item,{name:"address2",children:(0,I.jsx)(le.Z,{})}),(0,I.jsx)(oe.Z.Item,{name:"address3",children:(0,I.jsx)(le.Z,{})}),(0,I.jsx)(oe.Z.Item,{name:"address4",children:(0,I.jsx)(le.Z,{})}),(0,I.jsx)(oe.Z.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please input your phone number!"},{min:10,message:"Please input a valid phone number!"}],children:(0,I.jsx)(le.Z,{})}),(0,I.jsx)(oe.Z.Item,{name:"race",label:"Race",rules:[{required:!0,message:"Please select your race!"}],children:(0,I.jsxs)(se.Z,{placeholder:"Select your race",children:[(0,I.jsx)(ye,{value:"Melayu",children:"Melayu"}),(0,I.jsx)(ye,{value:"Cina",children:"Cina"}),(0,I.jsx)(ye,{value:"Indian",children:"Indian"}),(0,I.jsx)(ye,{value:"Bumiputera",children:"Bumiputera"}),(0,I.jsx)(ye,{value:"Non-Warganegara",children:"Non-Warganegara"}),(0,I.jsx)(ye,{value:"Lain-Lain",children:"Lain-Lain"})]})}),(0,I.jsx)(oe.Z.Item,{name:"nationality",label:"Nationality",rules:[{required:!0,message:"Please select your nationality!"}],children:(0,I.jsx)(se.Z,{placeholder:"Select your nationality",children:pe.map((e=>(0,I.jsx)(ye,{value:e,children:e},(0,Q.x0)())))})})]})]})})})]})};Ie.defaultProps={callback:void 0};var Ce=Ie,Se=t(21746),Te=t.n(Se),De=()=>{var e,n=(0,j.I0)(),t=(0,Z.useRef)([]),i=(0,j.v9)((e=>e.transaction)),l=i.cartItems,o=(0,j.v9)((e=>e.counter)),s=o.counter,d=(0,j.v9)((e=>e.config)),c=d.config,m=(0,j.v9)((e=>e.customer)),x=m.customer,f=m.customers,w=(0,j.v9)((e=>e.config)),k=w.pawnConditions,y=w.goldTypes,C=w.jewelleryTypes,S=(0,Z.useState)(),V=(0,p.Z)(S,2),ne=V[0],ie=V[1],le=(0,Z.useState)(!1),ae=(0,p.Z)(le,2),re=ae[0],oe=ae[1],se=(0,Z.useState)(!1),ue=(0,p.Z)(se,2),de=ue[0],ce=ue[1],ve=(0,Z.useState)(!1),pe=(0,p.Z)(ve,2),he=pe[0],me=pe[1],xe=(0,Z.useState)(!1),Ze=(0,p.Z)(xe,2),je=Ze[0],ge=Ze[1],fe=(0,Z.useState)(!1),be=(0,p.Z)(fe,2),we=(be[0],be[1]),ye=(0,Z.useState)([]),Ie=(0,p.Z)(ye,2),Se=Ie[0],De=Ie[1],Pe=(0,Z.useState)(""),Me=(0,p.Z)(Pe,2),Ne=Me[0],Ve=Me[1],Fe=(0,g.Nr)(Ne,800),Re=(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:5},sortOrder:"desc",sortField:"updatedAt",search:{},filters:{shopId:null===s||void 0===s||null===(e=s.shopId)||void 0===e?void 0:e._id}}}),[null===s||void 0===s||null===(e=s.shopId)||void 0===e?void 0:e._id]);(0,g.Dp)((()=>{n({type:"config/getGoldTypes"}),n({type:"config/getPawnConditions"}),n({type:"config/getJewelleryTypes"})}));var Ae=e=>{we(!0);var i=[...f,e];n({type:"customer/setCustomers",payload:{customers:i,total:i.length}}),t.current.forEach((n=>{var t;null===(t=n.current)||void 0===t||t.setFieldsValue({customerId:e._id})})),we(!1)},Ye=function(){var e=(0,N.Z)(F().mark((function e(t){var i,a,r,o,s;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return ce(!0),i=null!=(null===c||void 0===c?void 0:c.handlingFee)?null===c||void 0===c?void 0:c.handlingFee:0,a=0-+t.principalValue+i,e.next=5,Promise.all(Se.map(function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,J.Z.getDataUrlFromFile(n);case 2:return t=e.sent,e.abrupt("return",t.replace(/^data:image\/[a-z]+;base64,/,""));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 5:return r=e.sent,e.next=8,(0,X.jy)(t.customerId);case 8:return o=e.sent,n({type:"customer/setCustomer",payload:o}),s={actionType:ee.NEW,customer:o,transactionDetails:{customerId:t.customerId,principalValue:t.principalValue,interest:100,interestPackageId:t.interestPackageId,totalWeight:t.totalWeight,customerOccupation:t.customerOccupation,transferPurpose:t.transferPurpose,customerEmployerName:t.customerEmployerName,customerEmployerNature:t.customerEmployerNature,pawnType:t.pawnType,pawnItems:"Gold"===t.pawnType?t.goldPawnItems:t.otherPawnItems,totalToPay:a,netValue:a,imageFiles:r}},l.push(s),e.next=14,n({type:"transaction/setCartItems",payload:l});case 14:return oe(!1),De([]),M.ZP.success("Added to Cart"),ce(!1),e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_e=()=>(oe(!1),me(!1),ce(!1),De([]),!0),Be=e=>{n({type:"customer/getCustomers",params:e})},ze=e=>{var t=[...f,e];n({type:"customer/setCustomers",payload:{customers:t,total:t.length}})},Ee=function(){var e=(0,N.Z)(F().mark((function e(t){var i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==(null===t||void 0===t?void 0:t.nricPassport)||""===(null===t||void 0===t?void 0:t.nricPassport)){e.next=17;break}return Ve(t.nricPassport),e.prev=2,e.next=5,(0,X.OL)((0,v.Z)((0,v.Z)({},Re),{},{searchCustomer:t.nricPassport,pagination:{pageSize:1}}));case 5:return i=e.sent,e.next=8,n({type:"customer/setCustomers",payload:i});case 8:if(null==i.customers[0]){e.next=11;break}return e.next=11,n({type:"customer/setCustomer",payload:i.customers[0]});case 11:e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](2),console.log(e.t0),M.ZP.error("scan ic callback error!");case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(n){return e.apply(this,arguments)}}(),Le=(0,Z.useState)({fetchCustomers:Be,setCustomers:ze}),Oe=(0,p.Z)(Le,1),We=Oe[0];(0,Z.useEffect)((()=>{var e=!1;return Fe&&!e&&We.fetchCustomers((0,v.Z)((0,v.Z)({},Re),{},{search:{nricPassport:Fe}})),null==(null===t||void 0===t?void 0:t.current)||null==x||e||(ge(!0),We.setCustomers(x),t.current.forEach((e=>{var n;null===(n=e.current)||void 0===n||n.setFieldsValue({customerId:null===x||void 0===x?void 0:x._id})})),ge(!1)),()=>{e=!0}}),[Fe,We,Re,x]);var qe=(e,n)=>(0,I.jsx)(b.Z,{type:"text",icon:(0,I.jsx)(R.Z,{}),danger:!0,onClick:()=>{n.remove(e.name)}},"delete"),Ge=(e,n)=>{var t=e.listDom,i=e.action;n.record;return(0,I.jsx)(_.ZP,{bordered:!0,extra:i,title:"Pawn Item",style:{marginBottom:8},children:t})};return(0,I.jsxs)(T.ZP,{locale:H.Z,children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(A.Z,{}),className:Te().bigButton,onClick:()=>oe(!0),children:"Pawn New Item"}),(0,I.jsx)(h.Z,{title:"Pawn New Item",width:888,onCancel:_e,visible:re,footer:null,destroyOnClose:!0,maskClosable:!1,children:(0,I.jsxs)(z.L,{onFinish:Ye,formMapRef:t,formProps:{validateMessages:{required:"Required!"}},submitter:{render:e=>0===e.step?(0,I.jsxs)("div",{style:{width:520},children:[(0,I.jsx)(P.Z,{style:{margin:" 0 0 12px 0"}}),(0,I.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,I.jsx)(b.Z,{type:"primary",size:"large",onClick:()=>{var n;return null===(n=e.onSubmit)||void 0===n?void 0:n.call(e)},children:"Next"})})]}):1===e.step?[(0,I.jsxs)("div",{style:{width:612},children:[(0,I.jsx)(P.Z,{style:{margin:" 0 0 12px 0"}}),(0,I.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,I.jsxs)(r.Z,{children:[(0,I.jsx)(b.Z,{size:"large",onClick:()=>{var n;return null===(n=e.onPre)||void 0===n?void 0:n.call(e)},children:"Back"},"pre"),(0,I.jsx)(b.Z,{type:"primary",size:"large",onClick:()=>{var n;return null===(n=e.onSubmit)||void 0===n?void 0:n.call(e)},children:"Next"})]})})]},(0,Q.x0)())]:[(0,I.jsxs)("div",{style:{width:612},children:[(0,I.jsx)(P.Z,{style:{margin:" 0 0 12px 0"}}),(0,I.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,I.jsxs)(r.Z,{children:[(0,I.jsx)(b.Z,{size:"large",disabled:de,onClick:()=>{var n;return null===(n=e.onPre)||void 0===n?void 0:n.call(e)},children:"Back"},"gotoTwo"),(0,I.jsx)(b.Z,{type:"primary",size:"large",loading:de,onClick:()=>{var n;return null===(n=e.onSubmit)||void 0===n?void 0:n.call(e)},children:"Confirm"},"goToTree")]})})]},(0,Q.x0)())]},children:[(0,I.jsxs)(z.L.StepForm,{name:"overview",title:"Overview",initialValues:{customerId:null===x||void 0===x?void 0:x._id},children:[je?(0,I.jsx)(D.Z,{paragraph:{rows:1},active:!0}):(0,I.jsxs)(r.Z,{children:[(0,I.jsx)(E.Z,{name:"customerId",label:"Customer",showSearch:!0,width:520,debounceTime:800,fieldProps:{onSearch:e=>{var n;null!=e&&""!==e&&Be({filters:{shopId:null===s||void 0===s||null===(n=s.shopId)||void 0===n?void 0:n._id},searchCustomer:e})},notFoundContent:je?(0,I.jsx)(a.Z,{}):(0,I.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE,description:"Customer not found"})},options:te(null===f||void 0===f?void 0:f.map((e=>{var n,t;return{value:null!==(n=e._id)&&void 0!==n?n:"-",label:null!==(t="".concat(e.fullName," (").concat(e.nricPassport,")"))&&void 0!==t?t:"-"}}))),placeholder:"Enter NRIC",rules:[{required:!0,message:"Please select a customer"}],extra:(0,I.jsx)(Ce,{callback:Ae})}),(0,I.jsx)("div",{style:{marginTop:-33},children:(0,I.jsx)(ke,{callback:Ee})})]}),(0,I.jsxs)(B.ZP.Group,{children:[(0,I.jsx)(L.Z,{label:"Principle Value",name:"principalValue",locale:"ms-MY",initialValue:0,min:0,width:"sm",placeholder:"Input money to borrow",rules:[{required:!0,message:"Please enter a value for item principle"}]}),he?(0,I.jsx)("div",{style:{width:300},children:(0,I.jsx)(D.Z,{paragraph:{rows:1},active:!0})}):(0,I.jsx)(E.Z,{label:"Interest Packages",name:"interestPackageId",rules:[{required:!0}],width:270,placeholder:"Select a package",initialValue:ne,request:(0,N.Z)(F().mark((function e(){var n,t,i,l,a,r,o,u;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(me(!0),null==(null===s||void 0===s||null===(n=s.shopId)||void 0===n?void 0:n._id)){e.next=11;break}return e.next=4,(0,$.f)(null===s||void 0===s||null===(t=s.shopId)||void 0===t?void 0:t._id);case 4:return a=e.sent,r=null!==(i=null===a||void 0===a?void 0:a.interestPackages)&&void 0!==i?i:[],o=null==r?null:null===(l=r.find((e=>"Default Package"===e.interestDescription)))||void 0===l?void 0:l._id,ie(o),u=null===r||void 0===r?void 0:r.map((e=>{var n,t;return{value:null!==(n=e._id)&&void 0!==n?n:"-",label:null!==(t=e.interestDescription)&&void 0!==t?t:"-"}})),me(!1),e.abrupt("return",u);case 11:return me(!1),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})))})]}),(0,I.jsx)(O.Z,{name:["principalValue"],children:e=>{var n=e.principalValue;return n>=3e3?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(P.Z,{orientation:"left",orientationMargin:0,children:"Additional information for high value pawn (More than RM3000)"}),(0,I.jsx)(W.Z,{name:"customerOccupation",placeholder:"Occupation",label:"Customer's Occupation",rules:[{required:!0}]}),(0,I.jsx)(W.Z,{name:"transferPurpose",placeholder:"Purpose of Transfer",label:"Customer's Purpose of Transfer",rules:[{required:!0}]}),(0,I.jsx)(W.Z,{name:"customerEmployerName",placeholder:"Name of Employer",label:"Name of Customer's Employer",rules:[{required:!0}]}),(0,I.jsx)(W.Z,{name:"customerEmployerNature",placeholder:"Nature of Employer",label:"Nature of Customer's Employer",rules:[{required:!0}]})]}):null}})]}),(0,I.jsxs)(z.L.StepForm,{name:"Items",title:"Pawn Items",children:[(0,I.jsxs)(B.ZP.Group,{children:[(0,I.jsx)(E.Z,{label:"Pawn Type",name:"pawnType",rules:[{required:!0}],width:"sm",placeholder:"Select pawn item type",initialValue:"Gold",options:[{value:"Gold",label:"Gold"},{value:"Other",label:"Other"}]}),(0,I.jsx)(O.Z,{name:["pawnType"],children:e=>{var n=e.pawnType;return"Gold"===n?(0,I.jsx)(q.Z,{name:"totalWeight",label:"Total Weight (gram)",min:0,width:"sm",placeholder:"",rules:[{required:!0}]}):null}})]}),(0,I.jsx)(O.Z,{name:["pawnType"],children:e=>{var n=e.pawnType;return"Gold"===n?(0,I.jsx)(G.u,{name:"goldPawnItems",creatorButtonProps:{creatorButtonText:"Add Gold"},actionRender:(e,n)=>[qe(e,n)],itemRender:Ge,initialValue:[{quantity:1,pawnCondition:"-"}],children:function(e,n,t){var i;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(U.UW,{children:[(0,I.jsx)(W.Z,{name:"remarks",placeholder:"Special request",label:"Remarks"}),(0,I.jsx)(W.Z,{name:"description",placeholder:"Description of the item",label:"Description"})]}),(0,I.jsxs)(U.UW,{children:[(0,I.jsx)(q.Z,{name:"quantity",label:"Quantity",min:0,placeholder:"0",width:"xs",rules:[{required:!0}]}),(0,I.jsx)(E.Z,{label:"Jewellery Type",name:"jewelleryType",placeholder:"Select",rules:[{required:!0}],width:240,options:te(null===C||void 0===C||null===(i=C.filter((e=>"Gold"===e.pawnType)))||void 0===i?void 0:i.map((e=>({value:e.shortCode,label:e.codeDescription}))))}),(0,I.jsx)(E.Z,{label:"Gold Type",name:"goldType",placeholder:"Select",width:160,rules:[{required:!0}],options:te(null===y||void 0===y?void 0:y.map((e=>({value:e.shortCode,label:e.codeDescription}))))}),(0,I.jsx)(E.Z,{label:"Condition",name:"pawnCondition",placeholder:"Select",width:160,rules:[{required:!0}],options:te(null===k||void 0===k?void 0:k.map((e=>({value:e.shortCode,label:e.codeDescription}))))})]})]})}}):(0,I.jsx)(G.u,{name:"otherPawnItems",creatorButtonProps:{creatorButtonText:"Add Item"},actionRender:(e,n)=>[qe(e,n)],itemRender:Ge,initialValue:[{quantity:1}],children:function(e,n,t){var i;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(U.UW,{children:[(0,I.jsx)(W.Z,{name:"remarks",placeholder:"Special request",label:"Remarks"}),(0,I.jsx)(W.Z,{name:"description",placeholder:"Description of the item",label:"Description"})]}),(0,I.jsxs)(U.UW,{children:[(0,I.jsx)(q.Z,{name:"quantity",label:"Quantity",min:1,placeholder:"1",width:"xs",rules:[{required:!0}]}),(0,I.jsx)(E.Z,{label:"Jewellery Type",name:"jewelleryType",placeholder:"Select",rules:[{required:!0}],width:202,options:te(null===C||void 0===C||null===(i=C.filter((e=>"Other"===e.pawnType)))||void 0===i?void 0:i.map((e=>({value:e.shortCode,label:e.codeDescription}))))}),(0,I.jsx)(E.Z,{label:"Condition",name:"pawnCondition",placeholder:"Select",width:202,rules:[{required:!0}],options:te(null===k||void 0===k?void 0:k.map((e=>({value:e.shortCode,label:e.codeDescription}))))})]})]})}})}})]}),(0,I.jsx)(z.L.StepForm,{name:"itemPhotos",title:"Item Photos",children:(0,I.jsx)("div",{style:{width:612,display:"flex",justifyContent:"center"},children:(0,I.jsx)(K.Z,{name:"imageFiles",label:"",icon:(0,I.jsx)(Y.Z,{}),title:"Add Photo",max:10,rules:[{required:!0}],fieldProps:{listType:"picture-card",onRemove:e=>{var n=Se.indexOf(e),t=Se.slice();t.splice(n,1),De(t)},beforeUpload:function(){var e=(0,N.Z)(F().mark((function e(n){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={maxSizeMB:.6,useWebWorker:!0,fileType:"image/jpeg"},e.next=3,(0,J.Z)(n,t);case 3:return i=e.sent,console.log("compressedFile size ".concat(i.size/1024/1024," MB")),De([...Se,i]),e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()}})})})]})})]})},Pe=De,Me=t(92911),Ne=t(76570),Ve=t(8812),Fe=t(37217),Re=t.n(Fe),Ae=(t(22385),t(61580)),Ye=t(23538),_e=t(77283),Be=e=>{var n=e.callback,t=(0,Z.useState)(!1),i=(0,p.Z)(t,2),l=i[0],a=i[1],r=(0,Z.useState)(1e3),o=(0,p.Z)(r,1),s=o[0],u=(0,Z.useState)("No result"),d=(0,p.Z)(u,2),c=(d[0],d[1]),v=()=>{a(!0)},m=()=>{a(!1)},x=(e,t)=>{null!=(null===e||void 0===e?void 0:e.text)&&(c(null===e||void 0===e?void 0:e.text),n(null===e||void 0===e?void 0:e.text),a(!1))};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Ae.Z,{title:"Scan QR",children:(0,I.jsx)(b.Z,{icon:(0,I.jsx)(Ye.Z,{}),size:"large",style:{width:"40px"},onClick:v})}),(0,I.jsx)(h.Z,{title:"QR Scanning",width:400,visible:l,footer:null,onCancel:m,centered:!0,destroyOnClose:!0,children:(0,I.jsx)(_e.T,{scanDelay:s,onResult:x,constraints:{facingMode:"environment"}})})]})},ze=Be,Ee=se.Z.Option,Le=m.Z.Text,Oe=e=>{var n,t,o,s,u=(0,j.I0)(),d=(0,j.v9)((e=>e.loading.models.ticket)),c=((0,j.v9)((e=>e.loading.models.customer)),(0,j.v9)((e=>e.counter))),m=c.counter,x=(0,Z.useState)(!1),w=(0,p.Z)(x,2),k=w[0],y=w[1],C=(0,Z.useState)(!1),S=(0,p.Z)(C,2),T=S[0],P=S[1],V=(0,Z.useState)({pawnTickets:[],total:0}),R=(0,p.Z)(V,2),A=R[0],Y=R[1],_=(0,Z.useState)({customers:[],total:0}),B=(0,p.Z)(_,2),z=B[0],E=B[1],L=(0,Z.useState)("pawnNo"),O=(0,p.Z)(L,2),W=O[0],q=O[1],G=(0,Z.useState)(""),U=(0,p.Z)(G,2),K=U[0],H=U[1],J=(0,g.Nr)(W,800),Q=(0,g.Nr)(K,800),$=(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:5},sortOrder:"desc",sortField:"createdAt",search:{},filters:{shopId:null===m||void 0===m||null===(e=m.shopId)||void 0===e?void 0:e._id}}}),[null===m||void 0===m||null===(n=m.shopId)||void 0===n?void 0:n._id]),ee=(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:5},sortOrder:"desc",sortField:"createdAt",searchCustomer:"",search:{},filters:{shopId:null===m||void 0===m||null===(e=m.shopId)||void 0===e?void 0:e._id}}}),[null===m||void 0===m||null===(t=m.shopId)||void 0===t?void 0:t._id]),ne=(0,Z.useState)(ee),te=(0,p.Z)(ne,2),ie=te[0],ae=te[1],re=(0,Z.useState)($),oe=(0,p.Z)(re,2),ue=oe[0],de=oe[1],ce=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return P(!0),e.prev=1,e.next=4,(0,Me.SP)(n);case 4:t=e.sent,Y(t),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),M.ZP.error("error occurred!");case 11:P(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),pe=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return P(!0),e.prev=1,e.next=4,(0,X.OL)(n);case 4:t=e.sent,E(t),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),M.ZP.error("error occurred!");case 11:P(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),he=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,pe((0,v.Z)((0,v.Z)({},ie),{},{searchCustomer:Q,pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 2:ae((0,v.Z)((0,v.Z)({},ie),{},{searchCustomer:Q,pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),me={simple:!0,total:z.total,showSizeChanger:!0,onChange:function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,he(n);case 2:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}(),showTotal:(e,n)=>"".concat(n[0],"-").concat(n[1]," of ").concat(e," items"),current:ie.pagination.current,pageSize:ie.pagination.pageSize},xe=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ce((0,v.Z)((0,v.Z)({},ue),{},{search:{[J]:Q},pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 2:de((0,v.Z)((0,v.Z)({},ue),{},{search:{[J]:Q},pagination:{current:null!==n&&void 0!==n?n:1,pageSize:5}}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ze={simple:!0,total:A.total,showSizeChanger:!0,onChange:function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,xe(n);case 2:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}(),showTotal:(e,n)=>"".concat(n[0],"-").concat(n[1]," of ").concat(e," items"),current:ue.pagination.current,pageSize:ue.pagination.pageSize},je=(0,Z.useState)({fetchTickets:ce,fetchCustomers:pe}),ge=(0,p.Z)(je,1),fe=ge[0];(0,Z.useEffect)((()=>{var e=!1;return null==Q||""===Q||e||("customer"===J&&fe.fetchCustomers((0,v.Z)((0,v.Z)({},ee),{},{searchCustomer:Q})),"pawnNo"===J&&fe.fetchTickets((0,v.Z)((0,v.Z)({},$),{},{search:{[J]:Q}}))),()=>{e=!0}}),[J,Q,fe,ee,$]);var be=()=>{y(!0)},we=()=>{y(!1)},ye=e=>{H(e.target.value)},Ie=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u({type:"ticket/setTicket",payload:n});case 2:if(null==(null===n||void 0===n||null===(t=n.pawnTicketsSubId)||void 0===t?void 0:t.customerId)){e.next=5;break}return e.next=5,u({type:"customer/setCustomer",payload:n.pawnTicketsSubId.customerId});case 5:we();case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Se=function(){var e=(0,N.Z)(F().mark((function e(n){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u({type:"customer/setCustomer",payload:n});case 2:we();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Te=function(){var e=(0,N.Z)(F().mark((function e(n){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null==n||""===n){e.next=19;break}return P(!0),H(n),e.prev=3,e.next=6,(0,Me.SP)((0,v.Z)((0,v.Z)((0,v.Z)({},$),ue),{},{filters:{shopId:null===m||void 0===m||null===(t=m.shopId)||void 0===t?void 0:t._id},search:{pawnNo:n},pagination:{pageSize:1}}));case 6:if(i=e.sent,null==i.pawnTickets[0]){e.next=12;break}return e.next=10,Ie(i.pawnTickets[0]);case 10:e.next=13;break;case 12:Y(i);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](3),M.ZP.error("error occurred!");case 18:P(!1);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(n){return e.apply(this,arguments)}}(),De=function(){var e=(0,N.Z)(F().mark((function e(n){var t;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(P(!0),null==(null===n||void 0===n?void 0:n.nricPassport)||""===(null===n||void 0===n?void 0:n.nricPassport)){e.next=19;break}return H(n.nricPassport),e.prev=3,e.next=6,(0,X.OL)((0,v.Z)((0,v.Z)((0,v.Z)({},ee),ie),{},{searchCustomer:n.nricPassport,pagination:{pageSize:1}}));case 6:if(t=e.sent,null==t.customers[0]){e.next=12;break}return e.next=10,Se(t.customers[0]);case 10:e.next=13;break;case 12:E(t);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](3),console.log(e.t0),M.ZP.error("scan ic callback error!");case 19:P(!1);case 20:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(n){return e.apply(this,arguments)}}();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(Ne.Z,{}),className:Re().bigButton,onClick:be,children:"Search"}),(0,I.jsx)(h.Z,{title:"Search",width:600,visible:k,footer:null,okText:"Search",onCancel:we,centered:!0,destroyOnClose:!0,children:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{style:{marginTop:-16,marginBottom:16},children:(0,I.jsxs)(r.Z,{children:[(0,I.jsxs)(le.Z.Group,{compact:!0,children:[(0,I.jsxs)(se.Z,{defaultValue:W,size:"large",style:{width:"180px"},onChange:q,children:[(0,I.jsx)(Ee,{value:"customer",children:"Customer"}),(0,I.jsx)(Ee,{value:"pawnNo",children:"Pawn No"})]}),(0,I.jsx)(le.Z,{style:{width:320,height:40},size:"large",onChange:ye,value:K})]}),"pawnNo"===W?(0,I.jsx)(ze,{callback:Te}):(0,I.jsx)(ke,{buttonSize:"large",callback:De})]})}),(0,I.jsx)(l.Z,{title:"Search Result",size:"small",bordered:!1,children:"pawnNo"===W?(0,I.jsx)(a.Z,{tip:"Loading...",spinning:T||d||!1,children:(0,I.jsx)(i.ZP,{pagination:Ze,dataSource:null!==(o=A.pawnTickets)&&void 0!==o?o:[],renderItem:e=>{var n;return(0,I.jsx)(i.ZP.Item,{actions:[(0,I.jsx)(b.Z,{type:"text",icon:(0,I.jsx)(Ve.Z,{}),onClick:()=>Ie(e)})],children:(0,I.jsxs)(D.Z,{title:!1,loading:!1,active:!0,children:[(0,I.jsx)("div",{children:(0,I.jsx)(Le,{type:null!=(null===e||void 0===e?void 0:e.interestMonthCount)&&(null===e||void 0===e?void 0:e.interestMonthCount)>6?"danger":void 0,children:null!==(n=null===e||void 0===e?void 0:e.pawnNo)&&void 0!==n?n:"-"})}),(0,I.jsxs)("div",{children:["RM ",e.principalValue]}),(0,I.jsx)("div",{children:ve()(e.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)("div",{children:e.pawnTicketStatus})]})})}})}):(0,I.jsx)(a.Z,{tip:"Loading...",spinning:T,children:(0,I.jsx)(i.ZP,{footer:(0,I.jsx)(f.Z,{children:(0,I.jsx)(Ce,{callback:Se})}),pagination:me,dataSource:null!==(s=z.customers)&&void 0!==s?s:[],renderItem:e=>(0,I.jsx)(i.ZP.Item,{actions:[(0,I.jsx)(b.Z,{type:"text",icon:(0,I.jsx)(Ve.Z,{}),onClick:()=>Se(e)})],children:(0,I.jsxs)(D.Z,{title:!1,loading:!1,active:!0,children:[(0,I.jsx)("div",{children:e.nricPassport}),(0,I.jsx)("div",{children:e.fullName})]})})})})})]})})]})},We=Oe,qe=(t(71153),t(60331)),Ge=(t(38979),t(59466)),Ue=(t(77883),t(70507)),Ke=(t(66126),t(99177)),He=t(20924);function Je(e,n){var t=new Date(e),i=t.getDate();return t.setMonth(t.getMonth()+n),t.getDate()!==i&&t.setDate(0),t}var Qe=t(76063),Xe=t.n(Qe),$e=m.Z.Text,en=m.Z.Title,nn=e=>{var n,t,i,l=e.ticket,a=e.customer,r=e.callback,s=oe.Z.useForm(),u=(0,p.Z)(s,1),v=u[0],m=(0,j.I0)(),x=(0,j.v9)((e=>e.transaction.cartItems)),f=1,w=(null===l||void 0===l?void 0:l.interestValue)||0,k=null==(null===l||void 0===l?void 0:l.dueDate)?"-":Je(l.dueDate,f),y=(0,Z.useState)(!1),C=(0,p.Z)(y,2),S=C[0],T=C[1],D=(0,Z.useState)(f),V=(0,p.Z)(D,2),R=V[0],A=V[1],Y=(0,Z.useState)(k),_=(0,p.Z)(Y,2),B=_[0],z=_[1],E=(0,Z.useState)(w),L=(0,p.Z)(E,2),O=L[0],W=L[1],q=(0,Z.useState)(O),G=(0,p.Z)(q,2),U=G[0],K=G[1],H=(0,Z.useState)(1),J=(0,p.Z)(H,2),Q=J[0],X=J[1],$=(0,g.Nr)(Q,800),ne=()=>{T(!0)},te=()=>{T(!1)},ie=e=>{X(e)},le=e=>{var n={actionType:ee.EXTEND,customer:a,ticket:l,transactionDetails:{pawnTicketId:null===l||void 0===l?void 0:l._id,extendMonthCount:R,transactionDate:ve()().toISOString(),extendedDueDate:ve()(B).toISOString(),paid:O,totalToPay:O}};x.find((e=>{var t;return(null===e||void 0===e||null===(t=e.transactionDetails)||void 0===t?void 0:t.pawnTicketId)===n.transactionDetails.pawnTicketId}))?M.ZP.error("Ticket already in cart"):(x.push(n),m({type:"transaction/setCartItems",payload:x}),te(),M.ZP.success("Added to Cart"),r())};return(0,Z.useEffect)((()=>{var e=!1;if($&&!e){var n=function(){var e=(0,N.Z)(F().mark((function e(n){var t,i,a,r;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=null===l||void 0===l?void 0:l.dueDate,null!=t){e.next=5;break}M.ZP.error("This is an error message"),e.next=17;break;case 5:if(i=Je(t,n),e.t0=null!=(null===l||void 0===l?void 0:l.interestPackageId),!e.t0){e.next=11;break}return e.next=10,(0,Me.s3)({interestPackageId:l.interestPackageId,monthCount:n});case 10:e.t0=e.sent;case 11:a=e.t0,r=null!=(null===a||void 0===a?void 0:a.interestRate)&&null!=(null===l||void 0===l?void 0:l.principalValue)&&a.interestRate/100*l.principalValue||0,A(n),W(r),K(r),z(i);case 17:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();n($).catch(console.error)}return()=>{e=!0}}),[$,null===l||void 0===l?void 0:l.dueDate,null===l||void 0===l?void 0:l.interestPackageId,null===l||void 0===l?void 0:l.principalValue]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(He.Z,{}),className:Xe().actionButton,onClick:ne,disabled:"Renewed"===(null===l||void 0===l?void 0:l.pawnTicketStatus)||"Revalued"===(null===l||void 0===l?void 0:l.pawnTicketStatus)||"Redeemed"===(null===l||void 0===l?void 0:l.pawnTicketStatus)||"Void"===(null===l||void 0===l?void 0:l.pawnTicketStatus)||"Sold"===(null===l||void 0===l?void 0:l.pawnTicketStatus),children:"Extend"}),(0,I.jsxs)(h.Z,{title:"Extend (Pawn No: ".concat(null===l||void 0===l?void 0:l.pawnNo,")"),visible:S,width:600,footer:null,onCancel:te,centered:!0,destroyOnClose:!0,children:[null==l?null:(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===l||void 0===l?void 0:l.dueDate)?"-":ve()(l.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Principle (RM)",children:null==(null===l||void 0===l?void 0:l.principalValue)?"-":l.principalValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===l||void 0===l?void 0:l.createdAt)?"-":ve()(l.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===l||void 0===l?void 0:l.createdAt)?"-":ve()(l.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)($e,{type:null!=(null===l||void 0===l?void 0:l.interestMonthCount)&&(null===l||void 0===l?void 0:l.interestMonthCount)>6?"danger":void 0,children:null!=(null===l||void 0===l?void 0:l.interestMonthCount)?l.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===l||void 0===l||null===(n=l.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(l.pawnTicketsSubId.totalWeight,"g")})]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(oe.Z,{form:v,name:"basic",labelCol:{span:10},wrapperCol:{span:24},onFinish:le,autoComplete:"off",children:[(0,I.jsx)(oe.Z.Item,{name:"monthToPay",label:"Month",children:(0,I.jsxs)(d.Z,{children:[(0,I.jsx)(c.Z,{span:12,children:(0,I.jsx)(Ke.Z,{min:1,max:null!==(t=null===l||void 0===l?void 0:l.interestMonthCount)&&void 0!==t?t:1,onChange:ie,value:Q})}),(0,I.jsx)(c.Z,{span:4,children:(0,I.jsx)(Ue.Z,{min:1,max:null!==(i=null===l||void 0===l?void 0:l.interestMonthCount)&&void 0!==i?i:1,style:{margin:"0 16px"},value:Q,onChange:ie})})]})}),(0,I.jsx)(oe.Z.Item,{label:"Interest to Pay:",children:(0,I.jsxs)($e,{children:["RM ",O.toFixed(2)]})}),(0,I.jsx)(oe.Z.Item,{label:"Extended Due Date:",children:ve()(B).format("DD/MM/YYYY")}),(0,I.jsx)(oe.Z.Item,{label:"Net Total:",children:(0,I.jsxs)(en,{level:4,type:"success",style:{marginBottom:0},children:["RM ",U.toFixed(2)]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:te,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:Xe().submit,type:"primary",htmlType:"submit",children:"Add to Cart"})})]})]})]})]})},tn=nn,ln=(t(62350),t(75443)),an=t(88633),rn=t(49539),on=t(95657),sn=t.n(on),un=e=>{var n=e.ticket,t=e.customer,i=(e.callback,(0,j.v9)((e=>e.counter))),l=i.counter,a=(0,Z.useState)(!1),r=(0,p.Z)(a,2),o=r[0],s=r[1],u=(0,Z.useState)(),d=(0,p.Z)(u,2),c=d[0],v=d[1],h=(0,Z.useState)(!1),m=(0,p.Z)(h,2),x=m[0],g=m[1],f=function(){var e=(0,N.Z)(F().mark((function e(){var i,a,r,o;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s(!0),a={returnFile:"false",customerId:null===t||void 0===t?void 0:t._id,shopId:null===l||void 0===l||null===(i=l.shopId)||void 0===i?void 0:i._id,pawnTickets:null!=(null===n||void 0===n?void 0:n._id)?[n._id]:[]},e.prev=2,e.next=5,(0,Me.xA)(a);case 5:if(r=e.sent,!1!==r.ok){e.next=10;break}return M.ZP.error("error"),s(!1),e.abrupt("return",!1);case 10:return o=new Blob([new Uint8Array(Object.values(r)).buffer],{type:"application/pdf"}),v(o),c&&g(!0),s(!1),e.abrupt("return",!0);case 17:return e.prev=17,e.t0=e["catch"](2),s(!1),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=(0,N.Z)(F().mark((function e(){return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:g(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=()=>{g(!1)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ln.Z,{title:"Are you sure to report lost on this ticket?",okButtonProps:{loading:o},onConfirm:w,onCancel:k,okText:"Yes",cancelText:"No",children:(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(an.Z,{}),className:sn().actionButton,disabled:"Renewed"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Revalued"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Redeemed"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Void"===(null===n||void 0===n?void 0:n.pawnTicketStatus)||"Sold"===(null===n||void 0===n?void 0:n.pawnTicketStatus),children:"Lost Report"})}),(0,I.jsx)(rn.Z,{buttonTitle:"Print Lost Report",modalTitle:"Print Lost Report Priview",showModal:x,file:c,showTrigger:!1,onClose:k})]})},dn=un,cn=t(7945),vn=t(46888),pn=t.n(vn),hn=e=>{var n=(0,j.I0)(),t=e.ticket,i=(0,j.v9)((e=>e.counter)),l=i.counter,a=(0,j.v9)((e=>e.user)),r=a.currentUser,o=(0,j.v9)((e=>e.config)),s=o.printTicketSetting,u=(0,Z.useState)(!1),d=(0,p.Z)(u,2),c=d[0],v=d[1],h=(0,Z.useState)(),m=(0,p.Z)(h,2),x=m[0],f=m[1],w=(0,Z.useState)(!1),k=(0,p.Z)(w,2),y=k[0],C=k[1];(0,g.Dp)((0,N.Z)(F().mark((function e(){var t,i;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null===l||void 0===l||null===(t=l.shopId)||void 0===t||!t._id){e.next=3;break}return e.next=3,n({type:"config/getPrintTicketSetting",shopId:null===(i=l.shopId)||void 0===i?void 0:i._id});case 3:case"end":return e.stop()}}),e)}))));var S=function(){var e=(0,N.Z)(F().mark((function e(){var n,i,a,o;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c||null===t||void 0===t||!t._id||!s){e.next=10;break}return v(!0),i={shopId:null===l||void 0===l||null===(n=l.shopId)||void 0===n?void 0:n._id,userId:null===r||void 0===r?void 0:r._id,pawnTickets:[null===t||void 0===t?void 0:t._id],showMaxWidth:!1,returnFile:!1,pdfSettings:s},e.next=5,(0,Me._7)(i);case 5:a=e.sent,o=new Blob([new Uint8Array(Object.values(a)).buffer],{type:"application/pdf"}),f(o),C(!0),v(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",loading:c,icon:(0,I.jsx)(cn.Z,{}),onClick:S,className:pn().actionButton,disabled:"Active"!==(null===t||void 0===t?void 0:t.pawnTicketStatus),children:"Print Ticket"}),(0,I.jsx)(rn.Z,{buttonTitle:"Print Ticket",modalTitle:"Print Ticket Preview",file:x,onOpen:S,onClose:()=>C(!1),showModal:y,showTrigger:!1})]})},mn=hn,xn=(e,n)=>Number("".concat(Math.round(parseFloat("".concat(e,"e").concat(n))),"e-").concat(n)),Zn=(e,n)=>xn(e-n,2),jn=(e,n,t)=>xn(e+n+t,2),gn=(e,n)=>xn(e+n,2),fn=(e,n)=>xn(n/e*100,2),bn=(e,n)=>xn(n/100*e,2),wn=(e,n)=>xn(e+n,2),kn=t(18910),yn=t.n(kn),In=m.Z.Text,Cn=m.Z.Title,Sn=e=>{var n,t=e.ticket,i=e.customer,l=e.callback,r=oe.Z.useForm(),s=(0,p.Z)(r,1),u=s[0],m=(0,j.I0)(),x=(0,j.v9)((e=>e.transaction.cartItems)),g=(0,Z.useState)(!1),f=(0,p.Z)(g,2),w=f[0],k=f[1],y=(0,Z.useState)(!1),C=(0,p.Z)(y,2),S=C[0],T=C[1],D=(0,Z.useState)(0),V=(0,p.Z)(D,2),R=V[0],A=V[1];(0,Z.useEffect)((()=>{null!=(null===t||void 0===t?void 0:t.principalValue)&&null!=(null===t||void 0===t?void 0:t.interestValue)&&A(wn(t.principalValue,t.interestValue))}),[t]);var Y=function(){var e=(0,N.Z)(F().mark((function e(n){var i,l,a,r,o,s,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(T(!0),null!=n||null==(null===t||void 0===t?void 0:t.principalValue)||null==(null===t||void 0===t?void 0:t.interestValue)){e.next=6;break}i=wn(t.principalValue,t.interestValue),A(i),e.next=18;break;case 6:if(a=bn(null!==(l=null===t||void 0===t?void 0:t.interestValue)&&void 0!==l?l:0,n),r=u.getFieldsValue(),u.setFieldsValue((0,v.Z)((0,v.Z)({},r),{},{discountAmt:a})),e.t0=null!=(null===t||void 0===t?void 0:t._id),!e.t0){e.next=14;break}return e.next=13,(0,Me._9)({pawnTicketId:t._id,discount:a});case 13:e.t0=e.sent;case 14:o=e.t0,s=(null===o||void 0===o?void 0:o.interestValueAfterDiscount)||0,d=null!=(null===t||void 0===t?void 0:t.principalValue)?wn(t.principalValue,s):0,A(d);case 18:T(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=function(){var e=(0,N.Z)(F().mark((function e(n){var i,l,a,r,o,s,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(T(!0),null!=n||null==(null===t||void 0===t?void 0:t.principalValue)||null==(null===t||void 0===t?void 0:t.interestValue)){e.next=6;break}i=wn(t.principalValue,t.interestValue),A(i),e.next=18;break;case 6:if(a=fn(null!==(l=null===t||void 0===t?void 0:t.interestValue)&&void 0!==l?l:0,n),r=u.getFieldsValue(),u.setFieldsValue((0,v.Z)((0,v.Z)({},r),{},{discountRate:a})),e.t0=null!=(null===t||void 0===t?void 0:t._id),!e.t0){e.next=14;break}return e.next=13,(0,Me._9)({pawnTicketId:t._id,discount:n});case 13:e.t0=e.sent;case 14:o=e.t0,s=(null===o||void 0===o?void 0:o.interestValueAfterDiscount)||0,d=null!=(null===t||void 0===t?void 0:t.principalValue)?wn(t.principalValue,s):0,A(d);case 18:T(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),B=()=>{k(!0)},z=()=>{k(!1)},E=e=>{var n={actionType:ee.REDEEM,customer:i,ticket:t,transactionDetails:{pawnTicketId:null===t||void 0===t?void 0:t._id,interest:null===t||void 0===t?void 0:t.interestValue,discount:e.discountAmt,netValue:R,totalToPay:R}};x.find((e=>{var t;return(null===e||void 0===e||null===(t=e.transactionDetails)||void 0===t?void 0:t.pawnTicketId)===n.transactionDetails.pawnTicketId}))?M.ZP.error("Ticket already in cart"):(x.push(n),m({type:"transaction/setCartItems",payload:x}),z(),M.ZP.success("Added to Cart"),l())};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(He.Z,{}),className:yn().actionButton,onClick:B,disabled:"Renewed"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Revalued"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Redeemed"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Void"===(null===t||void 0===t?void 0:t.pawnTicketStatus)||"Sold"===(null===t||void 0===t?void 0:t.pawnTicketStatus),children:"Redeem"}),(0,I.jsxs)(h.Z,{title:"Redeem (Pawn No: ".concat(null===t||void 0===t?void 0:t.pawnNo,")"),visible:w,width:600,footer:null,onCancel:z,centered:!0,destroyOnClose:!0,children:[null==t?null:(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===t||void 0===t?void 0:t.dueDate)?"-":ve()(t.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Principle (RM)",children:null==(null===t||void 0===t?void 0:t.principalValue)?"-":t.principalValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===t||void 0===t?void 0:t.createdAt)?"-":ve()(t.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===t||void 0===t?void 0:t.createdAt)?"-":ve()(t.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(In,{type:null!=(null===t||void 0===t?void 0:t.interestMonthCount)&&(null===t||void 0===t?void 0:t.interestMonthCount)>6?"danger":void 0,children:null!=(null===t||void 0===t?void 0:t.interestMonthCount)?t.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===t||void 0===t||null===(n=t.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(t.pawnTicketsSubId.totalWeight,"g")}),(0,I.jsx)(o.Z.Item,{label:"Interest (RM)",children:null==(null===t||void 0===t?void 0:t.interestValue)?"-":null===t||void 0===t?void 0:t.interestValue.toFixed(2)})]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(oe.Z,{form:u,name:"basic",labelCol:{span:10},wrapperCol:{span:24},initialValues:{discountRate:0,discountAmt:0},onFinish:E,autoComplete:"off",children:[(0,I.jsx)(oe.Z.Item,{label:"Interest Discount Rate:",name:"discountRate",children:(0,I.jsx)(Ue.Z,{min:0,max:100,addonAfter:"%",onChange:Y})}),(0,I.jsx)(oe.Z.Item,{label:"Interest Discount Amount:",name:"discountAmt",children:(0,I.jsx)(Ue.Z,{min:0,controls:!1,addonBefore:"RM",onChange:_})}),(0,I.jsx)(oe.Z.Item,{label:"Net Total:",children:S?(0,I.jsx)(a.Z,{}):(0,I.jsxs)(Cn,{level:4,type:"success",style:{marginBottom:0},children:["RM ",R.toFixed(2)]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:z,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:yn().submit,type:"primary",htmlType:"submit",children:"Add to Cart"})})]})]})]})]})},Tn=Sn,Dn=t(11493),Pn=t.n(Dn),Mn=m.Z.Title,Nn=m.Z.Text,Vn=e=>{var n,t,i=e.ticket,l=e.customer,r=e.callback,s=oe.Z.useForm(),u=(0,p.Z)(s,1),m=u[0],x=(0,j.I0)(),f=(0,j.v9)((e=>e.transaction.cartItems)),w=(0,j.v9)((e=>e.config)),k=w.config,y=(0,Z.useState)(!1),C=(0,p.Z)(y,2),S=C[0],T=C[1],D=(0,Z.useState)(!1),V=(0,p.Z)(D,2),R=V[0],A=V[1],Y=(0,Z.useState)(0),_=(0,p.Z)(Y,2),B=_[0],z=_[1];(0,Z.useEffect)((()=>{var e;null!=(null===i||void 0===i?void 0:i.interestValue)&&z(gn(i.interestValue,null!==(e=null===k||void 0===k?void 0:k.handlingFee)&&void 0!==e?e:.5))}),[null===k||void 0===k?void 0:k.handlingFee,i]);var E=function(){var e=(0,N.Z)(F().mark((function e(n){var t,l,a,r,o,s;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l=null==(null===i||void 0===i?void 0:i.interestValue)?0:bn(i.interestValue,n),a=m.getFieldsValue(),m.setFieldsValue((0,v.Z)((0,v.Z)({},a),{},{discountAmt:l})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=8;break}return e.next=7,(0,Me._9)({pawnTicketId:i._id,discount:l});case 7:e.t0=e.sent;case 8:r=e.t0,o=(null===r||void 0===r?void 0:r.interestValueAfterDiscount)||0,s=xn(o+(null!==(t=null===k||void 0===k?void 0:k.handlingFee)&&void 0!==t?t:.5),2),z(s);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),L=function(){var e=(0,N.Z)(F().mark((function e(n){var t,l,a,r,o,s;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(A(!0),l=null==(null===i||void 0===i?void 0:i.interestValue)?0:fn(i.interestValue,n),a=m.getFieldsValue(),m.setFieldsValue((0,v.Z)((0,v.Z)({},a),{},{discountRate:l})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=9;break}return e.next=8,(0,Me._9)({pawnTicketId:i._id,discount:n});case 8:e.t0=e.sent;case 9:r=e.t0,o=(null===r||void 0===r?void 0:r.interestValueAfterDiscount)||0,s=xn(o+(null!==(t=null===k||void 0===k?void 0:k.handlingFee)&&void 0!==t?t:.5),2),z(s),A(!1);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=()=>{T(!0)},W=()=>{T(!1),z(0)},q=e=>{var n={actionType:ee.RENEW,customer:l,ticket:i,transactionDetails:{pawnTicketId:null===i||void 0===i?void 0:i._id,discount:e.discountAmt,netValue:B,totalToPay:B}};f.find((e=>{var t;return(null===e||void 0===e||null===(t=e.transactionDetails)||void 0===t?void 0:t.pawnTicketId)===n.transactionDetails.pawnTicketId}))?M.ZP.error("Ticket already in cart"):(f.push(n),x({type:"transaction/setCartItems",payload:f}),W(),M.ZP.success("Added to Cart"),r())};return(0,g.Dp)((()=>{x({type:"config/getConfig"})})),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(He.Z,{}),className:Pn().actionButton,onClick:O,disabled:"Renewed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Revalued"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Redeemed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Void"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Sold"===(null===i||void 0===i?void 0:i.pawnTicketStatus),children:"Renew"}),(0,I.jsxs)(h.Z,{title:"Renew (Pawn No: ".concat(null===i||void 0===i?void 0:i.pawnNo,")"),visible:S,width:600,footer:null,onCancel:W,centered:!0,destroyOnClose:!0,children:[null!=i&&(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===i||void 0===i?void 0:i.dueDate)?"-":ve()(i.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Principle",children:null==(null===i||void 0===i?void 0:i.principalValue)?"-":"RM ".concat(i.principalValue.toFixed(2))}),(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":ve()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":ve()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(Nn,{type:null!=(null===i||void 0===i?void 0:i.interestMonthCount)&&(null===i||void 0===i?void 0:i.interestMonthCount)>6?"danger":void 0,children:null!=(null===i||void 0===i?void 0:i.interestMonthCount)?i.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===i||void 0===i||null===(n=i.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(i.pawnTicketsSubId.totalWeight,"g")}),(0,I.jsx)(o.Z.Item,{label:"Interest Amount",children:null==(null===i||void 0===i?void 0:i.interestValue)?"-":"RM ".concat(null===i||void 0===i?void 0:i.interestValue.toFixed(2))})]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(oe.Z,{form:m,labelCol:{span:10},wrapperCol:{span:24},initialValues:{discountRate:0,discountAmt:0},onFinish:q,autoComplete:"off",children:[(0,I.jsx)(oe.Z.Item,{label:"Interest Discount Rate:",name:"discountRate",children:(0,I.jsx)(Ue.Z,{min:0,max:100,addonAfter:"%",onChange:E})}),(0,I.jsx)(oe.Z.Item,{label:"Interest Discount Amount:",name:"discountAmt",children:(0,I.jsx)(Ue.Z,{min:0,controls:!1,addonBefore:"RM",onChange:L})}),(0,I.jsx)(oe.Z.Item,{label:"Balance (+ Handling Fee: RM ".concat(null===k||void 0===k||null===(t=k.handlingFee)||void 0===t?void 0:t.toFixed(2),"): "),children:R?(0,I.jsx)(a.Z,{}):(0,I.jsxs)(Mn,{level:4,style:{marginBottom:0,marginLeft:4},children:["RM ",B.toFixed(2)]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:W,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:Pn().submit,type:"primary",htmlType:"submit",children:"Add to Cart"})})]})]})]})]})},Fn=Vn,Rn=t(42921),An=t.n(Rn),Yn=m.Z.Text,_n=m.Z.Title,Bn=se.Z.Option,zn=e=>{var n,t,i=e.ticket,l=e.customer,r=e.callback,s=(0,j.I0)(),u=oe.Z.useForm(),m=(0,p.Z)(u,1),x=m[0],f=(0,j.v9)((e=>e.counter)),w=f.counter,k=(0,j.v9)((e=>e.interestPackage)),y=k.interestPackages,C=(0,j.v9)((e=>e.transaction.cartItems)),S=(0,j.v9)((e=>e.config)),T=S.config,D=(0,Z.useState)(!1),V=(0,p.Z)(D,2),R=V[0],A=V[1],Y=(0,Z.useState)(!1),_=(0,p.Z)(Y,2),B=_[0],z=_[1],E=(0,Z.useState)(0),L=(0,p.Z)(E,2),O=L[0],W=L[1],q=(0,Z.useState)(0),G=(0,p.Z)(q,2),U=G[0],K=G[1],H=e=>{if(null==e)W(0),K(0);else{var n,t,l,a=Zn(null!==(n=null===i||void 0===i?void 0:i.principalValue)&&void 0!==n?n:0,e);W(a);var r=jn(a,null!==(t=null===i||void 0===i?void 0:i.interestValue)&&void 0!==t?t:0,null!==(l=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==l?l:0);K(r)}},J=function(){var e=(0,N.Z)(F().mark((function e(n){var t,l,a,r,o,s,u,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(z(!0),null!=n||null==(null===i||void 0===i?void 0:i.principalValue)||null==(null===i||void 0===i?void 0:i.interestValue)){e.next=6;break}l=jn(O,i.interestValue,null!==(t=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==t?t:.5),K(l),e.next=18;break;case 6:if(r=bn((null===i||void 0===i?void 0:i.interestValue)||0,n),o=x.getFieldsValue(),x.setFieldsValue((0,v.Z)((0,v.Z)({},o),{},{discountAmt:r})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=14;break}return e.next=13,(0,Me._9)({pawnTicketId:i._id,discount:r});case 13:e.t0=e.sent;case 14:s=e.t0,u=(null===s||void 0===s?void 0:s.interestValueAfterDiscount)||0,d=jn(O,u,null!==(a=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==a?a:.5),K(d);case 18:z(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),X=function(){var e=(0,N.Z)(F().mark((function e(n){var t,l,a,r,o,s,u,d;return F().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(z(!0),null!=n||null==(null===i||void 0===i?void 0:i.principalValue)||null==(null===i||void 0===i?void 0:i.interestValue)){e.next=6;break}l=jn(O,i.interestValue,null!==(t=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==t?t:.5),K(l),e.next=18;break;case 6:if(r=fn((null===i||void 0===i?void 0:i.interestValue)||0,n),o=x.getFieldsValue(),x.setFieldsValue((0,v.Z)((0,v.Z)({},o),{},{discountRate:r})),e.t0=null!=(null===i||void 0===i?void 0:i._id),!e.t0){e.next=14;break}return e.next=13,(0,Me._9)({pawnTicketId:i._id,discount:n});case 13:e.t0=e.sent;case 14:s=e.t0,u=(null===s||void 0===s?void 0:s.interestValueAfterDiscount)||0,d=jn(O,u,null!==(a=null===T||void 0===T?void 0:T.handlingFee)&&void 0!==a?a:0),K(d);case 18:z(!1);case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),$=()=>{A(!0)},ne=()=>{A(!1),K(0),W(0)},te=e=>{var n={actionType:ee.REVALUE,customer:l,ticket:i,transactionDetails:{pawnTicketId:null===i||void 0===i?void 0:i._id,principalValue:e.newPrinciple,discount:e.discountAmt,interestPackageId:e.interestPackageId,totalToPay:U}};C.find((e=>{var t;return(null===e||void 0===e||null===(t=e.transactionDetails)||void 0===t?void 0:t.pawnTicketId)===n.transactionDetails.pawnTicketId}))?M.ZP.error("Ticket already in cart"):(C.push(n),s({type:"transaction/setCartItems",payload:C}),ne(),M.ZP.success("Added to Cart"),r())};return(0,g.Dp)((()=>{var e;s({type:"interestPackage/getInterestPackages",shopId:null===w||void 0===w||null===(e=w.shopId)||void 0===e?void 0:e._id}),s({type:"config/getConfig"})})),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(b.Z,{block:!0,type:"primary",icon:(0,I.jsx)(He.Z,{}),className:An().actionButton,onClick:$,disabled:"Renewed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Revalued"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Redeemed"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Void"===(null===i||void 0===i?void 0:i.pawnTicketStatus)||"Sold"===(null===i||void 0===i?void 0:i.pawnTicketStatus),children:"Revalue"}),(0,I.jsxs)(h.Z,{title:"Revalue (Pawn No: ".concat(null===i||void 0===i?void 0:i.pawnNo,")"),visible:R,width:600,footer:null,onCancel:ne,centered:!0,destroyOnClose:!0,children:[null!=i&&(0,I.jsx)("div",{style:{width:"100%"},children:(0,I.jsxs)(o.Z,{column:2,labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Issue Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":ve()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null==(null===i||void 0===i||null===(n=i.pawnTicketsSubId)||void 0===n?void 0:n.totalWeight)?"-":"".concat(i.pawnTicketsSubId.totalWeight,"g")}),(0,I.jsx)(o.Z.Item,{label:"Principle",children:null==(null===i||void 0===i?void 0:i.principalValue)?"-":"RM ".concat(i.principalValue)}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(Yn,{type:null!=(null===i||void 0===i?void 0:i.interestMonthCount)&&(null===i||void 0===i?void 0:i.interestMonthCount)>6?"danger":void 0,children:null!=(null===i||void 0===i?void 0:i.interestMonthCount)?i.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Current Due Date",children:null==(null===i||void 0===i?void 0:i.dueDate)?"-":ve()(i.dueDate).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"New Due Date",children:null==(null===i||void 0===i?void 0:i.createdAt)?"-":ve()(i.createdAt).format("DD/MM/YYYY")}),(0,I.jsx)(o.Z.Item,{label:"Current Interest",children:null==(null===i||void 0===i?void 0:i.interestValue)?"-":"RM ".concat(null===i||void 0===i?void 0:i.interestValue.toFixed(2))}),(0,I.jsx)(o.Z.Item,{label:"Current Principle",children:null==(null===i||void 0===i?void 0:i.principalValue)?"-":"RM ".concat(i.principalValue.toFixed(2))})]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(oe.Z,{form:x,labelCol:{span:10},wrapperCol:{span:24},initialValues:{discountRate:0,discountAmt:0,interestPackageId:null===i||void 0===i?void 0:i.interestPackageId},onFinish:te,autoComplete:"off",children:[(0,I.jsx)(oe.Z.Item,{label:"New Principle Amount:",name:"newPrinciple",rules:[{required:!0,message:"Please enter the new principle amount!"}],children:(0,I.jsx)(Ue.Z,{min:0,controls:!1,addonBefore:"RM",onChange:H})}),(0,I.jsx)(oe.Z.Item,{label:"Revalue Amount:",tooltip:"[New Principle Amount \u2013 Old Principle Amount]\n            If is negative means client is paying back more, \n            if is positive means client is borrowing more.",children:(0,I.jsx)(Yn,{children:O<0?"- RM ".concat(Math.abs(O).toFixed(2)):"RM ".concat(O.toFixed(2))})}),(0,I.jsx)(oe.Z.Item,{label:"New Interest Package:",name:"interestPackageId",rules:[{required:!0,message:"Please enter interest package!"}],children:(0,I.jsx)(se.Z,{style:{width:216},children:null!=y&&(null===y||void 0===y?void 0:y.length)>0&&y.map((e=>{var n;return(0,I.jsx)(Bn,{value:e._id,children:null!==(n=e.interestDescription)&&void 0!==n?n:"-"},(0,Q.x0)())}))})}),(0,I.jsx)(oe.Z.Item,{label:"Interest Discount Rate:",name:"discountRate",children:(0,I.jsx)(Ue.Z,{min:0,max:100,addonAfter:"%",onChange:J})}),(0,I.jsx)(oe.Z.Item,{label:"Interest Discount Amount:",name:"discountAmt",children:(0,I.jsx)(Ue.Z,{min:0,controls:!1,addonBefore:"RM",onChange:X})}),(0,I.jsx)(oe.Z.Item,{label:"Balance (+ Handling Fee: RM ".concat(null===T||void 0===T||null===(t=T.handlingFee)||void 0===t?void 0:t.toFixed(2),"): "),children:B?(0,I.jsx)(a.Z,{}):(0,I.jsxs)(_n,{level:4,type:U<0?"warning":"success",style:{marginBottom:0,marginLeft:4},children:["RM ",U.toFixed(2)]})}),(0,I.jsx)(P.Z,{plain:!0}),(0,I.jsxs)(d.Z,{gutter:16,justify:"end",children:[(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",onClick:ne,children:"Cancel"})}),(0,I.jsx)(c.Z,{children:(0,I.jsx)(b.Z,{size:"large",className:An().submit,type:"primary",htmlType:"submit",disabled:0===U,children:"Add to Cart"})})]})]})]})]})},En=zn,Ln=e=>{var n=e.ticket,t=e.customer,i=e.callback;return(0,I.jsx)("div",{style:{marginBottom:8},children:(0,I.jsxs)(r.Z,{align:"start",size:"small",children:[(0,I.jsx)(Tn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(Fn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(En,{customer:t,ticket:n,callback:i}),(0,I.jsx)(tn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(dn,{customer:t,ticket:n,callback:i}),(0,I.jsx)(mn,{ticket:n})]})})},On=Ln,Wn=t(66502),qn=t(99562),Gn=t(60281),Un=(m.Z.Title,m.Z.Text),Kn=e=>{var n,t,a,r,u,v,m,x=e.ticket,j=e.customer,g=e.openTicketModal,f=x.pawnTicketsSubId,b=f.pawnItems,w=(f.pawnTickets,f.imageFiles),k=(0,Z.useState)(g),y=(0,p.Z)(k,2),C=y[0],S=y[1],T=(0,Z.useState)(!1),D=(0,p.Z)(T,2),M=D[0],N=(D[1],()=>{S(!0)}),V=()=>{S(!1)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(i.ZP.Item,{style:{padding:0},children:null!=x&&(0,I.jsx)(Gn.Z,{ticket:x,onClick:N})}),(0,I.jsxs)(h.Z,{title:"Ticket Details",visible:C,width:800,confirmLoading:M,onCancel:V,footer:null,centered:!0,destroyOnClose:!0,children:[null!=x&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(On,{customer:j,ticket:x,callback:V}),(0,I.jsx)("div",{style:{marginTop:24,marginBottom:24},children:(0,I.jsxs)(d.Z,{gutter:16,children:[(0,I.jsx)(c.Z,{span:8,children:null!=w&&w.length>0?(0,I.jsx)(Ge.Z,{autoplay:!0,children:null!=w&&w.length>0&&w.map((e=>(0,I.jsx)(re.Z,{width:200,height:200,src:e.publicUrl},(0,Q.x0)())))}):(0,I.jsx)(s.C,{shape:"square",size:150,icon:(0,I.jsx)(qn.Z,{})})}),(0,I.jsxs)(c.Z,{span:16,children:[(0,I.jsxs)(o.Z,{column:2,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Status",span:2,children:(0,I.jsx)(qe.Z,{color:(0,Wn.r)(null!==(n=null===x||void 0===x?void 0:x.pawnTicketStatus)&&void 0!==n?n:""),children:null===x||void 0===x?void 0:x.pawnTicketStatus})}),(0,I.jsx)(o.Z.Item,{label:"Pawn No",children:(0,I.jsx)(Un,{type:null!=(null===x||void 0===x?void 0:x.interestMonthCount)&&(null===x||void 0===x?void 0:x.interestMonthCount)>6?"danger":void 0,children:null!==(t=null===x||void 0===x?void 0:x.pawnNo)&&void 0!==t?t:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Pawn Date",children:null!==x&&void 0!==x&&x.createdAt?ve()(x.createdAt).format("DD/MM/YYYY"):"-"}),(0,I.jsx)(o.Z.Item,{label:"Month Count",children:(0,I.jsx)(Un,{type:null!=(null===x||void 0===x?void 0:x.interestMonthCount)&&(null===x||void 0===x?void 0:x.interestMonthCount)>6?"danger":void 0,children:null!=(null===x||void 0===x?void 0:x.interestMonthCount)?x.interestMonthCount:"-"})}),(0,I.jsx)(o.Z.Item,{label:"Interest (RM)",children:null==(null===x||void 0===x?void 0:x.interestValue)?"-":null===x||void 0===x?void 0:x.interestValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Principle (RM)",children:null==(null===x||void 0===x?void 0:x.principalValue)?"-":null===x||void 0===x?void 0:x.principalValue.toFixed(2)}),(0,I.jsx)(o.Z.Item,{label:"Due Date",children:null!==x&&void 0!==x&&x.dueDate?ve()(x.dueDate).format("DD/MM/YYYY"):"-"}),(0,I.jsx)(o.Z.Item,{label:"Total Weight",children:null!==(a=x.pawnTicketsSubId)&&void 0!==a&&a.totalWeight?"".concat(x.pawnTicketsSubId.totalWeight,"g"):"-"}),(0,I.jsx)(o.Z.Item,{label:"Total Items",children:null!=(null===(r=x.pawnTicketsSubId)||void 0===r?void 0:r.pawnItems)?null===(u=x.pawnTicketsSubId)||void 0===u||null===(v=u.pawnItems)||void 0===v?void 0:v.reduce(((e,n)=>{var t;return e+(null!==(t=null===n||void 0===n?void 0:n.quantity)&&void 0!==t?t:0)}),0):"-"})]}),(0,I.jsx)(P.Z,{orientation:"left",plain:!0,orientationMargin:0,children:"Customer"}),(0,I.jsxs)(o.Z,{column:1,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"NRIC/Passport",children:null!==(m=null===j||void 0===j?void 0:j.nricPassport)&&void 0!==m?m:"-"}),(0,I.jsx)(o.Z.Item,{label:"Full Name",children:null===j||void 0===j?void 0:j.fullName})]})]})]})})]}),(0,I.jsx)(P.Z,{orientation:"left",orientationMargin:0,children:"Item Details (".concat(null===b||void 0===b?void 0:b.length,")")}),(0,I.jsx)(i.ZP,{style:{marginTop:8},dataSource:b,grid:{gutter:16,xs:1,sm:2,md:3},renderItem:e=>(0,I.jsx)(i.ZP.Item,{children:(0,I.jsxs)(l.Z,{size:"small",style:{width:180},bodyStyle:{padding:8},children:[(0,I.jsx)(Un,{strong:!0,children:"".concat(e.jewelleryType," (").concat(null===e||void 0===e?void 0:e.quantity,")")}),(0,I.jsx)(P.Z,{style:{margin:"4px 0px"}}),(0,I.jsxs)(o.Z,{column:1,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Condition",children:e.pawnCondition||"-"}),(0,I.jsx)(o.Z.Item,{label:"Gold Type",children:e.goldType||"-"})]})]})})}),(0,I.jsx)(P.Z,{plain:!0,style:{margin:"8px 0"}}),(0,I.jsx)("h3",{children:"Ticket Log"}),(0,I.jsx)("div",{id:"scrollableDiv",style:{overflow:"auto"},children:(0,I.jsx)(i.ZP,{itemLayout:"horizontal",dataSource:x.pawnTicketsSubId.pawnTickets,renderItem:e=>(0,I.jsx)(Gn.Z,{pawnTicketsSub:x.pawnTicketsSubId,ticket:e})})})]})]})};Kn.defaultProps={openTicketModal:!1};var Hn=Kn,Jn=m.Z.Text,Qn=()=>{var e,n,t,m,b=(0,j.I0)(),w=(0,j.v9)((e=>e.loading.models.ticket)),k=(0,j.v9)((e=>e.loading.models.customer)),y=(0,j.v9)((e=>e.customer)),C=y.customer,T=(0,j.v9)((e=>e.counter)),D=T.counter,P=(0,j.v9)((e=>e.ticket)),M=P.ticket,N=P.tickets,V=(0,g.dz)(),F=V.height,R=(V.width,(0,Z.useMemo)((()=>{var e;return{pagination:{current:1,pageSize:999},sortOrder:"desc",sortField:"createdAt",search:{},filters:{shopId:null===D||void 0===D||null===(e=D.shopId)||void 0===e?void 0:e._id}}}),[null===D||void 0===D||null===(e=D.shopId)||void 0===e?void 0:e._id])),A=e=>{h.Z.error({title:"This is a black-listed customer",content:"Reason: ".concat(null!==e&&void 0!==e?e:"-")})};function Y(e){switch(e){case"Active":return"success";case"Non-Active":return"warning";case"Blacklisted":return"danger";default:return"secondary"}}var _=e=>{b({type:"ticket/getTickets",params:e})},B=(0,Z.useState)({fetchTickets:_}),z=(0,p.Z)(B,1),E=z[0];return(0,g.Dp)((()=>{b({type:"setting/getSettings"}),b({type:"config/getConfig"})})),(0,Z.useEffect)((()=>{var e=!1;return null!==C&&void 0!==C&&C._id&&!e&&(E.fetchTickets((0,v.Z)((0,v.Z)({},R),{},{searchPawnTicketByCustomer:C._id})),"Blacklisted"===(null===C||void 0===C?void 0:C.accountStatus)&&A(null===C||void 0===C?void 0:C.blacklistedReason)),()=>{e=!0}}),[E,C,R]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(d.Z,{gutter:16,children:[(0,I.jsx)(c.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(Pe,{})}),(0,I.jsx)(c.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(S,{})}),(0,I.jsx)(c.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(We,{})})]}),(0,I.jsx)(l.Z,{title:"Customer Info",size:"small",bordered:!1,bodyStyle:{padding:"8px 0"},children:(0,I.jsx)(a.Z,{tip:"Loading...",spinning:null!==k&&void 0!==k&&k,children:null==C||null==C._id?(0,I.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE}):(0,I.jsxs)(r.Z,{size:"small",align:"start",children:[(0,I.jsx)(s.C,{shape:"square",size:80,icon:(0,I.jsx)(x.Z,{}),src:null===C||void 0===C||null===(n=C.imageFile)||void 0===n?void 0:n.publicUrl}),(0,I.jsxs)(o.Z,{column:2,size:"small",labelStyle:{fontWeight:"bold"},children:[(0,I.jsx)(o.Z.Item,{label:"Status",children:(0,I.jsx)(Jn,{type:Y(null!==(t=C.accountStatus)&&void 0!==t?t:""),children:C.accountStatus})}),null!==(m="Blacklisted"===(null===C||void 0===C?void 0:C.accountStatus))&&void 0!==m?m:(0,I.jsx)(o.Z.Item,{label:"Blacklisted Reason",children:null===C||void 0===C?void 0:C.blacklistedReason}),(0,I.jsx)(o.Z.Item,{label:"NRIC/Passport",children:C.nricPassport}),(0,I.jsx)(o.Z.Item,{label:"NRIC/Passport 2",children:C.nricPassport2}),(0,I.jsx)(o.Z.Item,{label:"Full Name",children:C.fullName}),(0,I.jsx)(o.Z.Item,{label:"Phone",children:C.phoneNumber}),(0,I.jsx)(o.Z.Item,{label:"Gender",children:C.gender}),(0,I.jsx)(o.Z.Item,{label:"Race",children:C.race})]})]})})}),(0,I.jsx)(l.Z,{title:"Ticket List",size:"small",bordered:!1,headStyle:{padding:0},bodyStyle:{padding:"8px 0 0"},children:w?(0,I.jsx)(f.Z,{children:(0,I.jsx)(a.Z,{tip:"Loading...",style:{padding:64}})}):(0,I.jsx)("div",{id:"scrollableDiv",style:{height:F-400,overflow:"auto"},children:null==C||null==C._id||null==N?(0,I.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE}):(0,I.jsx)(i.ZP,{split:!1,size:"small",itemLayout:"horizontal",dataSource:N,renderItem:e=>(0,I.jsx)(Hn,{customer:C,ticket:e,openTicketModal:(null===M||void 0===M?void 0:M._id)===e._id})})})})]})},Xn=Qn}}]);